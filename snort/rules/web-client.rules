# Copyright 2001-2005 Sourcefire, Inc. All Rights Reserved
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2005 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2005 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#
# $Id: web-client.rules,v 1.92.6.121 2010/02/25 17:23:04 vrtbuild Exp $
#---------------
# WEB-CLIENT RULES
#---------------
#
# These signatures look for two things:
# * bad things coming from our users
# * attacks against our web users

alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Outlook EML access"; flow:from_client,established; uricontent:".eml"; metadata:policy security-ips drop; reference:nessus,10767; classtype:attempted-user; sid:1233; rev:12;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft emf metafile access"; flow:from_client,established; uricontent:".emf"; metadata:policy security-ips drop; reference:bugtraq,10120; reference:bugtraq,9707; reference:cve,2003-0906; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS04-032.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS05-053.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS06-001.mspx; classtype:attempted-user; sid:2435; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft wmf metafile access"; flow:from_client,established; uricontent:".wmf"; nocase; flowbits:set, wmf.download; metadata:service http; classtype:attempted-user; sid:2436; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT XMLHttpRequest attempt"; flow:to_client,established; content:"new XMLHttpRequest|28|"; content:"file|3A|//"; nocase; metadata:policy security-ips drop; reference:bugtraq,4628; reference:cve,2002-0354; classtype:web-application-attack; sid:1735; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT readme.eml download attempt"; flow:from_client,established; uricontent:"/readme.eml"; nocase; metadata:policy security-ips drop; reference:url,www.cert.org/advisories/CA-2001-26.html; classtype:attempted-user; sid:1284; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT readme.eml autoload attempt"; flow:to_client,established; content:"window.open|28 22|readme.eml|22|"; nocase; metadata:policy security-ips drop; reference:url,www.cert.org/advisories/CA-2001-26.html; classtype:attempted-user; sid:1290; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Javascript document.domain attempt"; flow:to_client,established; content:"document.domain|28|"; nocase; metadata:policy security-ips drop; reference:bugtraq,5346; reference:cve,2002-0815; classtype:attempted-user; sid:1840; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Javascript URL host spoofing attempt"; flow:to_client,established; content:"javascript|3A|//"; nocase; metadata:service http; reference:bugtraq,5293; classtype:attempted-user; sid:1841; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealPlayer playlist file URL overflow attempt"; flow:from_server,established; flowbits:isset,realplayer.playlist; content:"file|3A|//"; nocase; pcre:"/^file\x3a\x2f\x2f[^\n]{400}/smi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,9579; reference:cve,2004-0258; classtype:attempted-user; sid:2438; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealPlayer playlist http URL overflow attempt"; flow:from_server,established; flowbits:isset,realplayer.playlist; content:"http|3A|//"; nocase; pcre:"/^http\x3a\x2f\x2f[^\n]{400}/smi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,9579; reference:cve,2004-0258; classtype:attempted-user; sid:2439; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealPlayer playlist rtsp URL overflow attempt"; flow:from_server,established; flowbits:isset,realplayer.playlist; content:"rtsp|3A|//"; nocase; pcre:"/^http\x3a\x2f\x2f[^\n]{400}/smi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,9579; reference:cve,2004-0258; classtype:attempted-user; sid:2440; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Norton antivirus sysmspam.dll load attempt"; flow:to_client,established; content:"clsid|3A|"; nocase; content:"0534CF61-83C5-4765-B19B-45F7A4E135D0"; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,9916; reference:cve,2004-0363; classtype:attempted-admin; sid:2485; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT local resource redirection attempt"; flow:to_client,established; content:"Location|3A|"; nocase; pcre:"/^Location\x3a(\s*|\s*\r?\n\s+)*URL\s*\x3a/smi"; metadata:policy security-ips drop; reference:cve,2004-0549; reference:url,www.kb.cert.org/vuls/id/713878; classtype:attempted-user; sid:2577; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Content-Disposition CLSID command attempt"; flow:to_client,established; content:"Content-Disposition|3A|"; nocase; pcre:"/^Content-Disposition\x3a(\s*|\s*\r?\n\s+)[^\r\n]*\{[\da-fA-F]{8}(-[\da-fA-F]{4}){3}-[\da-fA-F]{12}\}/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,9510; reference:cve,2004-0420; reference:url,www.microsoft.com/technet/security/bulletin/ms04-024.mspx; classtype:attempted-user; sid:2589; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT bitmap BitmapOffset integer overflow attempt"; flow:to_client,established; content:"image/bmp"; nocase; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)image\x2fbmp/smi"; pcre:"/^BM/sm"; byte_test:4,>,2147480000,8,relative,little; metadata:policy security-ips drop; reference:bugtraq,9663; reference:cve,2004-0566; reference:url,www.microsoft.com/technet/security/bulletin/ms04-025.mspx; classtype:attempted-user; sid:2671; rev:7;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT libpng tRNS overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:4; distance:4; content:"tRNS"; distance:0; byte_test:4,>,256,-8,relative,big; pcre:"/IHDR(?!.*?PLTE).*?tRNS/s"; metadata:policy security-ips drop; reference:bugtraq,10872; reference:cve,2004-0597; classtype:attempted-user; sid:2673; rev:5;)

# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT JPEG parser heap overflow attempt"; flow:from_server,established; content:"Content-Type"; nocase; content:"image/"; within:20; nocase; content:"|0A FF D8|"; distance:0; fast_pattern; pcre:"/^.*\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/sR"; metadata:policy security-ips drop; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,www.microsoft.com/security/bulletins/200409_jpeg.mspx; classtype:attempted-user; sid:2705; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT JPEG transfer"; flow:from_server,established; content:"image/"; nocase; pcre:"/^Content-Type\x3a(\s*|\s*\r?\n\s+)image\x2fp?jpe?g/smi"; flowbits:set,http.jpeg; flowbits:noalert; metadata:policy security-ips drop; classtype:protocol-command-decode; sid:2706; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT JPEG parser multipacket heap overflow"; flow:from_server,established; flowbits:isset,http.jpeg; content:"|FF|"; pcre:"/\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/"; metadata:policy security-ips drop; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,www.microsoft.com/security/bulletins/200409_jpeg.mspx; classtype:attempted-admin; sid:2707; rev:3;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft ANI file parsing overflow"; flow:established,from_server; content:"RIFF"; nocase; content:"anih"; nocase; byte_test:4,>,36,0,relative,little; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2004-1049; reference:cve,2007-1765; reference:url,www.microsoft.com/technet/security/bulletin/MS05-002.mspx; classtype:attempted-user; sid:3079; rev:7;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT winamp .cda file name overflow attempt"; flow:from_server,established; content:".cda"; nocase; pcre:"/(\x5c[^\x5c]{16,}|\x2f[^\x2f]{16,})\.cda$/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,11730; reference:cve,2004-1119; reference:nessus,15817; classtype:attempted-user; sid:3088; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT PNG large image width download attempt"; flow:from_server,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,0,relative; metadata:policy security-ips drop; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:3132; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT PNG large colour depth download attempt"; flow:from_server,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:1,>,16,8,relative; metadata:policy security-ips drop; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:3134; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT PNG large image height download attempt"; flow:from_server,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,4,relative; metadata:policy security-ips drop; reference:bugtraq,11481; reference:bugtraq,11523; reference:cve,2004-0599; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:3133; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT object type overflow attempt"; flow:from_server,established; content:"<OBJECT"; nocase; pcre:"/<OBJECT\s+[^>]*type\s*=[\x22\x27]\x2f{32}/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2003-0344; reference:url,www.microsoft.com/technet/security/bulletin/MS03-020.mspx; classtype:attempted-user; sid:3149; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player directory traversal via Content-Disposition attempt"; flow:from_server,established; content:"Content-Disposition|3A|"; nocase; content:"filename="; distance:0; nocase; pcre:"/[^\x3b\x3a\r\n]*(\x25\x2e\x25\x2e\x25\x5c|\x25\x32\x65\x25\x35\x63|\x2e\x2e\x5c)[^\x3b\x3a\r\n]*\x2ewmz/smi"; metadata:policy security-ips drop; reference:bugtraq,7517; reference:cve,2003-0228; reference:nessus,11595; reference:url,www.microsoft.com/technet/security/bulletin/MS03-017.mspx; classtype:attempted-user; sid:3192; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT winhelp clsid attempt"; flow:from_server,established; content:"adb880a6-d8ff-11cf-9377-00aa003b7a11"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*adb880a6-d8ff-11cf-9377-00aa003b7a11/si"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,11467; reference:bugtraq,4857; reference:bugtraq,5874; reference:cve,2002-0693; reference:cve,2002-0823; reference:cve,2004-1043; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;KB828750; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;Q293338; reference:url,www.microsoft.com/technet/security/bulletin/MS02-055.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS05-001.mspx; reference:url,www.ngssoftware.com/advisories/ms-winhlp.txt; classtype:attempted-user; sid:3148; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealPlayer VIDORV30 header length buffer overflow"; flow:to_client,established; content:".RMF"; nocase; content:"VIDORV30"; distance:0; byte_test:4,>,1000000,-16,relative; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,11309; reference:cve,2004-1481; reference:url,www.eeye.com/html/research/advisories/AD20041001.html; classtype:attempted-admin; sid:3470; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT iTunes playlist URL overflow attempt"; flow:from_server,established; content:"[playlist]"; pcre:"/^File[0-9]+=http\x3a\x2f\x2f[^\n]{150}/Rsmi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,12238; reference:cve,2005-0043; classtype:attempted-user; sid:3471; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealPlayer SMIL file overflow attempt"; flow:to_client, established; content:"application/smi"; nocase; content:"system-screen-size=|22|"; nocase; isdataat:256; content:!"|22|"; within:256; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,12698; reference:cve,2005-0455; classtype:attempted-user; sid:3473; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF multipacket heap overflow - NETSCAPE2.0"; flow:from_server,established; flowbits:isset,http.gif; content:"GIF"; content:"!|FF 0B|NETSCAPE2.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:1,>,0x7f,3,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:3536; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GIF transfer"; flow:from_server,established; content:"image/"; nocase; pcre:"/^Content-Type\x3a(\s*|\s*\r?\n\s+)image\x2fgif/smi"; flowbits:set,http.gif; flowbits:noalert; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; classtype:protocol-command-decode; sid:3535; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF single packet heap overflow - NETSCAPE2.0"; flow:from_server,established; content:"image/"; pcre:"/^Content-Type\s*\x3a(\s*|\s*\r?\n\s+)image\x2fgif/smi"; content:"GIF"; distance:0; content:"!|FF 0B|NETSCAPE2.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:1,>,0x7f,3,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:3534; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HTML DOM invalid DHTML element creation attempt"; flow:to_client,established; content:"createElement"; pcre:"/(\w+)\s*=\s*\w+\.createElement\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createElement\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop, service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:3549; rev:12;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT .hta download attempt"; flow:to_server,established; uricontent:".hta"; nocase; pcre:"/\.hta(\b|$)/Ui"; flowbits:set,http.hta; flowbits:noalert; metadata:policy security-ips drop; classtype:not-suspicious; sid:3551; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HTML http/https scheme hostname overflow attempt"; flow:to_client,established; content:"http"; nocase; content:"|3A|//"; within:4; pcre:"/=\s*\x22\s*http(s)?\x3a\x2f\x2f[^\x3a\x2f@\s\x22\x3F\x26]{255}|=\s*\x27\s*http(s)?\x3a\x2f\x2f[^\x3a\x2f@\s\x27\x3F\x26]{255}|=\s*http(s)?\x3a\x2f\x2f[^\x3a\x2f@\s\x3F\x26]{255}/i"; reference:bugtraq,33894; reference:cve,2005-0554; reference:cve,2009-0187; classtype:attempted-user; sid:3550; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT bitmap transfer"; flow:to_client,established; content:"image/bmp"; nocase; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)image\x2fbmp/smi"; flowbits:set,http.bmp; flowbits:noalert; metadata:service http; classtype:protocol-command-decode; sid:3633; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Bitmap width integer overflow multipacket attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"BM"; byte_test:4,>,83386080,16,relative,little; metadata:policy security-ips drop; reference:bugtraq,11171; reference:cve,2004-0904; reference:cve,2008-3015; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=255067; reference:url,www.microsoft.com/technet/security/bulletin/MS08-052.mspx; classtype:attempted-admin; sid:3634; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Bitmap width integer overflow attempt"; flow:established,to_client; content:"image/bmp"; nocase; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)image\x2fbmp/smi"; pcre:"/\r\n\r\n|\r\r|\n\n/Rsm"; content:"BM"; distance:0; byte_test:4,>,83386080,16,relative,little; metadata:policy security-ips drop; reference:bugtraq,11171; reference:cve,2004-0904; reference:cve,2008-3015; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=255067; reference:url,www.microsoft.com/technet/security/bulletin/MS08-052.mspx; classtype:attempted-admin; sid:3632; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Firefox IFRAME src javascript code execution"; flow:from_server,established; content:"IFRAME"; nocase; pcre:"/\x3c\s*IFRAME\s*[^\x3e]*src=\x22javascript\x3a/smi"; metadata:policy security-ips drop; reference:bugtraq,13544; reference:cve,2005-1476; reference:nessus,18243; classtype:attempted-user; sid:3679; rev:4;)
# alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT spoofed MIME-Type auto-execution attempt"; flow:from_server,established; content:"Content-Type|3A|"; nocase; content:"audio/"; fast_pattern; nocase; pcre:"/Content-Type\x3A\s+audio\/(x-wav|mpeg|x-midi)/i"; content:"filename="; distance:0; nocase; pcre:"/filename=[\x22\x27]?.{1,221}\.(vbs|exe|scr|pif|bat)/i"; metadata:policy security-ips drop, service http; reference:bugtraq,2524; reference:cve,2001-0154; reference:url,www.microsoft.com/technet/security/bulletin/MS01-020.mspx; classtype:attempted-admin; sid:3683; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT bitmap BitmapOffset multipacket integer overflow attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"BM"; pcre:"/^BM/sm"; byte_test:4,>,2147480000,8,relative,little; metadata:policy security-ips drop; reference:bugtraq,9663; reference:cve,2004-0566; reference:url,www.microsoft.com/technet/security/bulletin/ms04-025.mspx; classtype:attempted-user; sid:3685; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Internet Explorer tRNS overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:4; distance:4; content:"tRNS"; distance:0; byte_test:4,>,256,-8,relative,big; metadata:policy security-ips drop; reference:bugtraq,13941; reference:cve,2005-1211; reference:nessus,18490; reference:url,www.microsoft.com/technet/security/bulletin/MS05-025.mspx; classtype:attempted-user; sid:3689; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IE javaprxy.dll COM access"; flow:from_server,established; content:"03D9F3F2-B0E3-11D2-B081-006008039BF0"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*03D9F3F2-B0E3-11D2-B081-006008039BF0/si"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,14087; reference:cve,2005-2087; reference:url,www.microsoft.com/technet/security/bulletin/ms05-037.mspx; reference:url,www.osvdb.org/displayvuln.php?osvdb_id=17680; classtype:attempted-user; sid:3814; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT multipacket CHM file transfer attempt"; flow:to_client,established; flowbits:isset,chm_content_type; content:"ITSF"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,13953; reference:cve,2005-1208; reference:nessus,18482; reference:url,www.microsoft.com/technet/security/bulletin/ms05-026.mspx; classtype:attempted-user; sid:3820; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT multipacket CHM file transfer start"; flow:to_client,established; content:"text/plain"; nocase; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)text\x2fplain/smi"; flowbits:set,chm_content_type; flowbits:noalert; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; classtype:protocol-command-decode; sid:3819; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT CHM file transfer attempt"; flow:to_client,established; content:"text/plain"; nocase; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)text\x2fplain/smi"; pcre:"/^ITSF/sm"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,13953; reference:cve,2005-1208; reference:nessus,18482; reference:url,www.microsoft.com/technet/security/bulletin/ms05-026.mspx; classtype:attempted-user; sid:3821; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT msdds clsid attempt"; flow:from_server,established; content:"EC444CB6-3E7E-4865-B1C3-0DE72EF39B3F"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*EC444CB6-3E7E-4865-B1C3-0DE72EF39B3F/si"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,14594; reference:cve,2005-1990; reference:cve,2005-2127; reference:url,www.frsirt.com/english/advisories/2005/1450; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4132; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT devenum clsid attempt"; flow:from_server,established; content:"083863F1-70DE-11d0-BD40-00A0C911CE86"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*083863F1-70DE-11d0-BD40-00A0C911CE86/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4133; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IE JPEG heap overflow single packet attempt"; flow:to_client,established; content:"image/"; nocase; pcre:"/^Content-Type\s*\x3a(\s*|\s*\r?\n\s+)image\x2fp?jpe?g/smi"; content:"|FF C0|"; content:"|FF DA|"; distance:0; pcre:"/\xFF\xC0[^\xFF]{8}(([^\xFF])[^\xFF]{2})(([^\xFF])[^\xFF]{2})?(([^\xFF])[^\xFF]{2})?(([^\xFF])[^\xFF]{2})?\xFF.*\xFF\xDA[^\xFF]{2}[\x01-\x04](?(?=\2)[^\xFF]{2}(?(4)(?(?=\4)[^\xFF]{2}(?(6)(?(?=\6)[^\xFF]{2}(?(8)(?(?=\8)(?!))|(?!)))|(?!)))|(?!)))/s"; metadata:policy security-ips drop, service http; reference:bugtraq,14282; reference:bugtraq,14284; reference:cve,2005-1988; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-dos; sid:4135; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT blnmgr clsid attempt"; flow:from_server,established; content:"3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4134; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IE JPEG heap overflow multipacket attempt"; flow:to_client,established; flowbits:isset,http.jpeg; content:"|FF C0|"; content:"|FF DA|"; distance:0; pcre:"/\xFF\xC0[^\xFF]{8}(([^\xFF])[^\xFF]{2})(([^\xFF])[^\xFF]{2})?(([^\xFF])[^\xFF]{2})?(([^\xFF])[^\xFF]{2})?\xFF.*\xFF\xDA[^\xFF]{2}[\x01-\x04](?(?=\2)[^\xFF]{2}(?(4)(?(?=\4)[^\xFF]{2}(?(6)(?(?=\6)[^\xFF]{2}(?(8)(?(?=\8)(?!))|(?!)))|(?!)))|(?!)))/s"; metadata:policy security-ips drop, service http; reference:bugtraq,14282; reference:bugtraq,14284; reference:cve,2005-1988; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-dos; sid:4136; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT multipacket CBO CBL CBM file transfer attempt"; flow:to_client,established; flowbits:isset,bookmark_link_content_type; content:"Interactive Training]"; pcre:"/\[(Microsoft |Microsoft Press )?Interactive Training\]/"; metadata:policy security-ips drop; reference:bugtraq,13944; reference:cve,2005-1212; reference:cve,2006-3448; reference:nessus,18492; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-005.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS05-031.mspx; classtype:attempted-user; sid:4195; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT CBO CBL CBM file transfer attempt"; flow:to_client,established; content:"text/plain"; nocase; content:"Interactive Training]"; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)text\x2fplain/smi"; pcre:"/\[(Microsoft |Microsoft Press )?Interactive Training\]/"; metadata:policy security-ips drop; reference:bugtraq,13944; reference:cve,2005-1212; reference:cve,2006-3448; reference:nessus,18492; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-005.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS05-031.mspx; classtype:attempted-user; sid:4196; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT multipacket CBO CBL CBM file transfer start"; flow:to_client,established; content:"text/plain"; nocase; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)text\x2fplain/smi"; flowbits:set,bookmark_link_content_type; flowbits:noalert; metadata:policy security-ips drop; classtype:protocol-command-decode; sid:4194; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT malformed windows shortcut file with comment buffer overflow attempt"; flow:from_server,established; content:"L|00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00|F"; byte_test:1,&,4,0,relative,little; byte_jump:2,56,relative,little; byte_jump:2,0,relative,little; byte_jump:2,-2,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,little; content:"|CC 00 00 00|"; within:4; distance:-2; isdataat:72,relative; content:!"|00 00|"; within:32; distance:40; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,15069; reference:bugtraq,15070; reference:cve,2005-2118; reference:cve,2005-2122; reference:url,www.microsoft.com/technet/security/bulletin/MS05-049.mspx; classtype:attempted-user; sid:4644; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT malformed windows shortcut file buffer overflow attempt"; flow:from_server,established; content:"L|00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00|F"; byte_test:1,!&,4,0,relative,little; byte_jump:2,56,relative,little; byte_jump:2,0,relative,little; byte_jump:2,-2,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,little; content:"|CC 00 00 00|"; within:4; distance:-2; isdataat:72,relative; content:!"|00 00|"; within:32; distance:40; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,15069; reference:bugtraq,15070; reference:cve,2005-2118; reference:cve,2005-2122; reference:url,www.microsoft.com/technet/security/bulletin/MS05-049.mspx; classtype:attempted-user; sid:4643; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Macromedia swf DOACTION tag overflow attempt"; flow:established,from_server; content:"FWS"; content:"|03|"; distance:19; content:!"|00|"; within:1; byte_test:1,<,128,0,relative; content:"|9B|"; within:1; distance:1; content:!"|00|"; within:1; distance:-2; metadata:policy security-ips drop; reference:url,www.macromedia.com/devnet/security/security_zone/mpsb05-07.html; classtype:attempted-user; sid:4675; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT internet explorer javascript onload overflow attempt"; flow:from_server,established; content:"body"; nocase; content:"onLoad"; distance:0; nocase; content:"window"; distance:0; nocase; pcre:"/<body\s+[^>]*onLoad\s*=\s*[\x22\x27]?window\(\)/smi"; metadata:policy security-ips drop; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4647; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT quicktime movie file component name integer overflow multipacket attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"hdlr"; nocase; byte_test:1,>,250,24,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,15308; reference:cve,2005-2754; reference:url,docs.info.apple.com/article.html?artnum=302772; classtype:attempted-user; sid:4679; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT quicktime movie file component name integer overflow attempt"; flow:to_client,established; content:"video/quicktime"; nocase; pcre:"/^Content-Type\x3A\s*video\x2Fquicktime/smi"; content:"hdlr"; nocase; byte_test:1,>,250,24,relative; metadata:policy security-ips drop; reference:bugtraq,15308; reference:cve,2005-2754; reference:url,docs.info.apple.com/article.html?artnum=302772; classtype:attempted-user; sid:4680; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT quicktime movie file transfer"; flow:to_client,established; content:"video/quicktime"; nocase; pcre:"/^Content-Type\x3A\s*video\x2F(quicktime|x-quicktime)/smi"; flowbits:set,http.quicktime; flowbits:noalert; metadata:service http; classtype:protocol-command-decode; sid:4678; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT internet explorer javascript onload document.write obfuscation overflow attempt"; flow:from_server,established; content:"document.write"; nocase; pcre:"/document\.write\(([^\x22\x27\x29\x3B]*([\x22\x27]))((?(?=\2)\2(?1)))\x3C(?3)b(?3)o(?3)d(?3)y(?3)\s*(?3)o(?3)n(?3)l(?3)o(?3)a(?3)d(?3)\s*(?3)=(?3)\s*(?3)w(?3)i(?3)n(?3)d(?3)o(?3)w(?3)\x28(?3)\x29/smi"; metadata:policy security-ips drop; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4916; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT internet explorer javascript onload prompt obfuscation overflow attempt"; flow:from_server,established; content:"prompt"; nocase; content:"fillmem"; distance:0; nocase; content:"body"; nocase; content:"onLoad"; distance:0; nocase; content:"setTimeout"; distance:0; nocase; pcre:"/prompt\(fillmem[^\)]*\).*<body\s+[^>]*onLoad\s*=\s*[\x22\x27]?setTimeout\(/smi"; metadata:policy security-ips drop; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4917; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Metasploit Windows picture and fax viewer wmf arbitrary code execution attempt"; flow:from_server,established; content:"|01 00 09 00 00 03|R|1F 00 00 06 00|=|00 00 00 00 00|"; content:"&|06 09 00 16 00|"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,16074; reference:cve,2005-4560; reference:url,www.microsoft.com/technet/security/bulletin/ms06-001.mspx; classtype:web-application-attack; sid:5319; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT wmf file arbitrary code execution attempt"; flow:from_server,established; content:"&"; content:"|09 00|"; within:2; distance:1; metadata:policy security-ips drop; reference:bugtraq,16074; reference:cve,2005-4560; reference:cve,2007-3034; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-046.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms06-001.mspx; classtype:web-application-attack; sid:5318; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player Plugin for Non-IE browsers buffer overflow attempt"; flow:from_server,established; content:"EMBED"; nocase; content:"src"; distance:0; nocase; pcre:"/<EMBED(\s+|\s+[^>]*?\s+)src\s*=\s*(\x22[^\x22]{2082,}\x22|\x27[^\x27]{2082,}\x27|[^\r\n\s]{2082,})/smi"; metadata:policy security-ips drop; reference:bugtraq,16644; reference:cve,2006-0005; reference:url,www.idefense.com/intelligence/vulnerabilities/display.php?id=393; reference:url,www.microsoft.com/technet/security/bulletin/ms06-006.mspx; classtype:attempted-user; sid:5710; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player zero length bitmap heap overflow attempt"; flow:established,to_client; content:"BM|00 00 00 00|"; pcre:"/^BM\x00\x00\x00\x00/sm"; metadata:policy security-ips drop; reference:bugtraq,16633; reference:cve,2006-0006; reference:url,www.eeye.com/html/research/advisories/AD20060214.html; reference:url,www.microsoft.com/technet/security/bulletin/ms06-005.mspx; classtype:attempted-admin; sid:5711; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Metafile invalid header size integer overflow"; flow:from_server,established; content:"|D7 CD C6 9A|"; byte_test:2,<,8,25,relative,little; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,16516; reference:cve,2006-0020; reference:url,www.microsoft.com/technet/security/bulletin/ms06-004.mspx; classtype:attempted-admin; sid:5713; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player invalid data offset bitmap heap overflow attempt"; flow:established,to_client; content:"BM"; byte_test:4,<,14,8,little,relative; pcre:"/^BM/sm"; metadata:policy security-ips drop; reference:bugtraq,16633; reference:cve,2006-0006; reference:url,www.eeye.com/html/research/advisories/AD20060214.html; reference:url,www.microsoft.com/technet/security/bulletin/ms06-005.mspx; classtype:attempted-admin; sid:5712; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft HTML help workshop file .hhp download attempt"; flow:to_server,established; uricontent:".hhp"; nocase; flowbits:set,http.hhp.download; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:5740; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft HTML help workshop buffer overflow attempt"; flow:from_server,established; flowbits:isset,http.hhp.download; content:"["; content:"]"; distance:0; content:"file"; distance:0; nocase; content:"="; distance:0; pcre:"/\x5B(OPTIONS|WINDOWS|MERGE FILES|MAP|ALIAS|TEXT\x20POPUPS|INFOTYPES|SUBSETS)\x5D.*(Contents|Index|Compiled|Sample List|Full text search stop list)\x20file\s*\x3D[^\r\n]{200,}/smi"; metadata:policy security-ips drop; reference:cve,2006-0564; reference:url,users.pandora.be/bratax/advisories/b008.html; reference:url,www.frsirt.com/english/advisories/2006/0446; classtype:attempted-user; sid:5741; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF single packet heap overflow - ANIMEXTS1.0"; flow:from_server,established; content:"image/"; pcre:"/^Content-Type\s*\x3a(\s*|\s*\r?\n\s+)image\x2fgif/smi"; content:"GIF"; distance:0; content:"!|FF 0B|ANIMEXTS1.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:1,>,0x7f,3,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:6502; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Internet Explorer mhtml uri shortcut buffer overflow attempt"; flow:to_client,established; content:"URL"; nocase; content:"mhtml|3A|//"; distance:0; nocase; pcre:"/^\s*URL\s*=\s*mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\r\n]{1253,}/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,18198; reference:cve,2006-2766; reference:url,www.microsoft.com/technet/security/bulletin/ms06-043.mspx; classtype:attempted-user; sid:6510; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT quicktime udta atom overflow attempt"; flow:to_client,established; content:"udta"; byte_test:4,>,4294967291,-8,relative; metadata:policy security-ips drop; reference:bugtraq,17953; reference:cve,2006-1460; classtype:attempted-user; sid:6506; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF multipacket heap overflow - ANIMEXTS1.0"; flow:from_server,established; flowbits:isset,http.gif; content:"GIF"; content:"!|FF 0B|ANIMEXTS1.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:1,>,0x7f,3,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:6503; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sophos Anti-Virus CAB file overflow attempt"; flow:to_client,established; content:"|0D 0A|MSCF"; byte_test:2,>,8192,22,little,relative; metadata:policy security-ips drop; reference:bugtraq,17876; reference:cve,2006-0994; classtype:attempted-admin; sid:6504; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT quicktime fpx file SectNumMiniFAT overflow attempt"; flow:to_client,established; content:"|D0 CF 11 E0 A1 B1 1A E1|"; depth:8; byte_test:4,>,8388606,56,little,relative; metadata:policy security-ips drop; reference:bugtraq,17074; reference:cve,2006-1249; classtype:attempted-user; sid:6505; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Internet Explorer mhtml uri href buffer overflow attempt"; flow:to_client,established; content:"mhtml|3A|//"; nocase; pcre:"/href\s*=\s*(\x22mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\x22]{1253,}|\x27mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\x27]{1253,}|mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\x09\r\n\x20]{1253,})/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,18198; reference:cve,2006-2766; reference:url,www.microsoft.com/technet/security/bulletin/ms06-043.mspx; classtype:attempted-user; sid:6509; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected hIST overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"hIST"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6694; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected tRNS overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"tRNS"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6695; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected pHYs overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"pHYs"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6696; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected sPLT overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"sPLT"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6697; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected sBIT overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"sBIT"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6691; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT PNG file transfer"; flow:established,to_client; content:"|89|PNG|0D 0A 1A 0A|"; flowbits:set,http.client.png; flowbits:noalert; metadata:policy security-ips drop; classtype:protocol-command-decode; sid:6688; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected bKGD overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"bkGD"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6693; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected tIME overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"tIME"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6698; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected zTXt overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"zTXt"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6701; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected iTXt overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"iTXt"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6699; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected cHRM overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"cHRM"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6689; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected tEXt overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"tEXt"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop, service http; reference:bugtraq,18385; reference:cve,2006-0025; reference:cve,2009-2501; reference:url,www.microsoft.com/technet/security/bulletin/MS09-062.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6700; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected sRGB overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"sRGB"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6692; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Malformed PNG detected iCCP overflow attempt"; flow:established,to_client; flowbits:isset,http.client.png; content:"iCCP"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6690; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel url unicode overflow attempt"; flow:to_client,established; content:"|E0 C9 EA|y|F9 BA CE 11 8C 82 00 AA 00|K|A9 0B|"; byte_test:4,>,3628,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,18422; reference:bugtraq,18500; reference:cve,2006-3059; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7002; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT windows explorer invalid url file overflow attempt"; flow:to_client,established; content:"[InternetShortcut]"; nocase; content:"url="; distance:0; nocase; content:"file|3A|file|3A|file|3A|"; distance:0; nocase; metadata:policy security-ips drop; reference:bugtraq,18838; classtype:denial-of-service; sid:7022; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel object record overflow attempt"; flow:to_client,established; flowbits:isset,excel.object; content:"]|00|"; byte_test:2,>,8224,1,relative; flowbits:unset,excel.object; metadata:policy security-ips drop; reference:cve,2006-1306; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7048; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT isComponentInstalled function buffer overflow"; flow:established,to_client; content:"isComponentInstalled"; nocase; isdataat:256,relative; pcre:"/isComponentInstalled\s*\([^,\)]{256}/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,16870; classtype:attempted-user; sid:7020; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel object record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"]"; content:"|05|"; within:8; flowbits:set,excel.object; flowbits:noalert; metadata:policy security-ips drop; reference:cve,2006-1306; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7047; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel url unicode overflow attempt"; flow:to_client,established; content:"n|DB 7C D2|m|AE CF 11 96 B8|DEST|00 00|"; content:"FWS"; within:3; distance:8; content:"javascript|3A|"; distance:0; nocase; metadata:policy security-ips drop; reference:bugtraq,18583; reference:cve,2006-3014; reference:url,www.microsoft.com/technet/security/bulletin/ms06-069.mspx; classtype:attempted-user; sid:7025; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel style handling overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|93 02|"; byte_test:2,>,733,4,relative,little; metadata:policy security-ips drop; reference:bugtraq,18872; reference:cve,2006-3431; reference:url,www.microsoft.com/technet/security/bulletin/ms06-059.mspx; classtype:attempted-user; sid:7024; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT xls file download"; flow:to_client,established; content:"|D0 CF 11 E0 A1 B1 1A E1|"; flowbits:set,xls.download; flowbits:noalert; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:url,sc.openoffice.org/excelfileformat.pdf; classtype:misc-activity; sid:7023; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT microsoft word document summary information string overflow attempt"; flow:to_client,established; content:"|02 D5 CD D5 9C|.|1B 10 93 97 08 00|+,|F9 AE|"; content:"|1E 00 00 00|"; distance:0; byte_test:4,>,2147483646,0,relative; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7202; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT microsoft word document summary information null string overflow attempt"; flow:to_client,established; content:"|02 D5 CD D5 9C|.|1B 10 93 97 08 00|+,|F9 AE|"; content:"|1E 00 00 00 00 00 00 00|"; distance:0; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7200; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT microsoft word summary information null string overflow attempt"; flow:to_client,established; content:"|E0 85 9F F2 F9|Oh|10 AB 91 08 00|+'|B3 D9|"; content:"|1E 00 00 00 00 00 00 00|"; distance:0; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7201; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel object ftCmo overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"]|00|"; content:"|15|"; distance:0; byte_test:2,>,30,2,relative; metadata:policy security-ips drop; reference:bugtraq,18886; reference:cve,2006-1306; classtype:attempted-user; sid:7204; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel FngGroupCount record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|9C 00|"; byte_test:2,>,14,2,relative; metadata:policy security-ips drop; reference:bugtraq,18890; reference:cve,2006-1308; classtype:attempted-user; sid:7205; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel MSO.DLL malformed string parsing multi byte buffer over attempt"; flow:to_client,established; content:"|00 00 00 00 00 00 1D 00 0F 00 03 00 00 00|"; content:"|00|"; within:1; distance:2; isdataat:6,relative; content:!"|00 00 00 00 00|"; within:5; distance:1; metadata:policy security-ips drop; reference:bugtraq,17252; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7198; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel label record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|02 04|"; byte_test:2,>,35071,2,relative; metadata:policy security-ips drop; reference:cve,2006-1309; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7199; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT excel MSO.DLL malformed string parsing single byte buffer over attempt"; flow:to_client,established; content:"|00 00 00 00 00 00 1D 00 0F 00 03 00 00 00|"; isdataat:2; content:!"|00|"; within:1; distance:2; metadata:policy security-ips drop; reference:bugtraq,17252; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7197; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT microsoft word information string overflow attempt"; flow:to_client,established; content:"|E0 85 9F F2 F9|Oh|10 AB 91 08 00|+'|B3 D9|"; content:"|1E 00 00 00|"; distance:0; byte_test:4,>,2147483646,0,relative; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7203; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla javascript navigator object access"; flow:to_client,established; content:"window.navigator"; nocase; content:"="; within:2; content:"java."; distance:0; nocase; metadata:policy security-ips drop; reference:bugtraq,19181; reference:cve,2006-3677; reference:url,www.mozilla.org/security/announce/2006/mfsa2006-45.html; classtype:attempted-user; sid:8058; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealPlayer Realpix file format string overflow attempt"; flow:established,to_client; content:"image"; nocase; content:"handle"; distance:0; nocase; pcre:"/<image[^>]*handle\s*=\s*\x22[^\x22]*\x25[^\x22]*\x22/smi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,14945; reference:cve,2005-2710; reference:url,www.frsirt.com/english/advisories/2005/1855; classtype:attempted-user; sid:8091; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT pub file download"; flow:to_client,established; content:"CHNKINK "; metadata:policy security-ips drop; reference:bugtraq,19951; reference:cve,2006-0001; reference:url,www.microsoft.com/technet/security/bulletin/ms06-054.mspx; classtype:misc-activity; sid:8350; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HCP URI uplddrvinfo access"; flow:established,to_client; content:"hcp|3A|"; nocase; content:"uplddrvinfo.htm?"; distance:0; nocase; content:"file|3A|"; distance:0; nocase; pcre:"/hcp\x3A[^\r\n]+uplddrvinfo\x2Ehtm\x3F[^\r\n]*file\x3A/smi"; metadata:policy security-ips drop; reference:bugtraq,5478; reference:cve,2002-0974; reference:url,www.microsoft.com/technet/security/bulletin/ms02-060.mspx; classtype:misc-activity; sid:8413; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GIF image width descriptor buffer overflow attempt"; flow:to_client,established; content:"GIF8"; content:"a"; within:1; distance:1; content:","; distance:0; byte_test:2,>,65428,4,relative; metadata:policy security-ips drop; reference:bugtraq,18915; reference:cve,2006-0007; reference:url,www.microsoft.com/technet/security/bulletin/ms06-039.mspx; classtype:attempted-user; sid:8414; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VML fill method overflow attempt"; flow:from_server,established; content:"|3A|fill"; nocase; pcre:"/<\w+\x3afill\s[^>]*method\s*=\s*(\x27[^\x27]{32}|\x22[^\x22]{32}|[^\s>]{32})/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,20096; reference:cve,2006-4868; reference:url,www.microsoft.com/technet/security/bulletin/ms06-055.mspx; classtype:attempted-user; sid:8416; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RTF file with embedded object package download attempt"; flow:from_server,established; content:"{|5C|rtf"; nocase; content:"{|5C|object|5C|objemb{|5C|*|5C|objclass Package}"; distance:0; nocase; metadata:policy security-ips drop; reference:cve,2006-4692; reference:url,www.microsoft.com/technet/security/bulletin/ms06-065.mspx; classtype:misc-activity; sid:8445; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Excel colinfo XF record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"}|00 0C 00 00 00|"; content:!"|00|"; within:1; distance:1; metadata:policy security-ips drop; reference:cve,2006-3875; reference:url,www.microsoft.com/technet/security/bulletin/ms06-059.mspx; classtype:attempted-user; sid:8448; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Publisher file download attempt"; flow:to_client,established; content:"CHNKINK "; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2006-0001; reference:url,www.microsoft.com/technet/security/bulletin/ms06-054.mspx; classtype:misc-activity; sid:8478; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Agent buffer overflow attempt"; flow:established,to_client; content:"|C4 AB CD AB|"; byte_test:4,<,500,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,21034; reference:cve,2006-3445; reference:url,www.microsoft.com/technet/security/bulletin/ms06-068.mspx; classtype:attempted-user; sid:9432; rev:2;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT Ultravox-Max-Msg header integer overflow attempt"; flow:to_client,established; content:"Ultravox-Max-Msg|3A|"; nocase; byte_test:10,>,65535,0,relative,string; metadata:policy security-ips drop; reference:bugtraq,20744; reference:cve,2006-5567; reference:url,www.winamp.com/player/version_history.php; classtype:attempted-user; sid:9434; rev:2;)
alert tcp $EXTERNAL_NET 5190 -> $HOME_NET any (msg:"WEB-CLIENT Ultravox-Max-Msg header integer overflow attempt"; flow:to_client,established; content:"Ultravox-Max-Msg|3A|"; nocase; byte_test:10,>,65535,0,relative,string; metadata:policy security-ips drop; reference:bugtraq,20744; reference:cve,2006-5567; reference:url,www.winamp.com/player/version_history.php; classtype:attempted-user; sid:9435; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Quicktime Movie link file URI security bypass attempt"; flow:to_client,established; content:"<?xml version"; nocase; content:"<?quicktime type=|22|application/x-quicktime-media-link"; distance:0; nocase; content:"qtnext=|22|file"; distance:0; nocase; metadata:policy security-ips drop; reference:bugtraq,20138; reference:cve,2006-4965; classtype:attempted-user; sid:9430; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Quicktime Movie link scripting security bypass attempt"; flow:to_client,established; content:"<?xml version"; nocase; content:"<?quicktime type=|22|application/x-quicktime-media-link"; distance:0; nocase; pcre:"/<embed[^>]*javascript/smi"; metadata:policy security-ips drop; reference:bugtraq,20138; reference:cve,2006-4965; classtype:attempted-user; sid:9429; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Agent buffer overflow attempt"; flow:established,to_client; content:"|C2 AB CD AB|"; byte_test:4,<,500,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,21034; reference:cve,2006-3445; reference:url,www.microsoft.com/technet/security/bulletin/ms06-068.mspx; classtype:attempted-user; sid:9433; rev:2;)
alert tcp $EXTERNAL_NET 8090 -> $HOME_NET any (msg:"WEB-CLIENT Ultravox-Max-Msg header integer overflow attempt"; flow:to_client,established; content:"Ultravox-Max-Msg|3A|"; nocase; byte_test:10,>,65535,0,relative,string; metadata:policy security-ips drop; reference:bugtraq,20744; reference:cve,2006-5567; reference:url,www.winamp.com/player/version_history.php; classtype:attempted-user; sid:9436; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Gnu gv buffer overflow attempt"; flow:to_client,established; content:"%%DocumentMedia|3A|"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; metadata:policy security-ips drop; reference:bugtraq,20978; reference:cve,2006-5864; classtype:attempted-user; sid:9619; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Download Manger dm.ini stack overflow attempt"; flow:to_client,established; content:"<?aom"; nocase; content:"<url>"; isdataat:271; content:!"</url>"; within:271; nocase; metadata:policy security-ips drop; reference:bugtraq,21453; reference:cve,2006-5856; classtype:attempted-user; sid:9637; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Address Book download attempt"; flow:to_client,established; content:"|9C CB CB 8D 13|u|D2 11 91|X|00 C0|OyV|A4|"; metadata:policy security-ips drop; reference:cve,2006-2386; reference:url,www.microsoft.com/technet/security/bulletin/ms06-076.mspx; classtype:attempted-user; sid:9639; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player ASX file ref href buffer overflow attempt"; flow:to_client,established; content:"<ref"; nocase; content:"href"; distance:0; nocase; pcre:"/<ref\s+href\s*=\s*\x22([^\x22]{2}|(\x25[0-9A-Z]{2}){1,2})\x3A\x2F[^\x22]{100,}/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,21247; reference:cve,2006-6134; reference:url,www.microsoft.com/technet/security/bulletin/ms06-078.mspx; classtype:attempted-user; sid:9625; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player ASF simple index object parsing buffer overflow attempt"; flow:to_client,established; content:"|90 08 00|3|B1 E5 CF 11 89 F4 00 A0 C9 03|I|CB|"; byte_test:4,>,715827882,36,relative,little; metadata:policy security-ips drop; reference:cve,2006-4702; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-078.mspx; classtype:attempted-user; sid:9641; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player ASF codec list object parsing buffer overflow attempt"; flow:to_client,established; content:"@R|D1 86 1D|1|D0 11 A3 A4 00 A0 C9 03|H|F6|"; byte_test:4,>,134217727,24,relative,little; metadata:policy security-ips drop; reference:cve,2006-4702; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-078.mspx; classtype:attempted-user; sid:9642; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player ASF marker object parsing buffer overflow attempt"; flow:to_client,established; content:"|01 CD 87 F4|Q|A9 CF 11 8E E6 00 C0 0C| Se"; byte_test:4,>,134217727,24,relative,little; metadata:policy security-ips drop; reference:cve,2006-4702; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-078.mspx; classtype:attempted-user; sid:9643; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player or Explorer Malformed RIFF File denial of service attempt"; flow:established,to_client; content:"MThd"; content:"|00 00 00 00 00 00|"; within:6; distance:4; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,21612; reference:cve,2006-6601; reference:url,www.milw0rm.com/exploits/3190; classtype:attempted-dos; sid:9801; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT QuickTime RTSP URI overflow attempt"; flow:from_server,established; content:"rtsp|3A|//"; nocase; pcre:"/(=\s*(('|\x22)rtsp\x3A[^\3]{200}|rstp\x3A[^\s\x3E]{200})|\x3Csrc\x3Ertsp\x3A[^\x3C]{200})/smi"; metadata:policy security-ips drop; reference:bugtraq,21829; reference:cve,2007-0015; reference:url,applefun.blogspot.com/2007/01/moab-01-01-2007-apple-quicktime-rtsp.html; classtype:attempted-user; sid:9823; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT QuickTime HREF Track Detected"; flow:established,to_client; flowbits:isset,http.quicktime; content:" T<"; pcre:"/A?<\s*[A-Za-z]{3,5}\x3A\x2F\x2F[^>]+> T</sm"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2007-0059; reference:url,projects.info-pull.com/moab/MOAB-03-01-2007.html; reference:url,www.apple.com/quicktime/tutorials/hreftracks.html; classtype:misc-activity; sid:9840; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Plugin Universal cross-site scripting attempt"; flow:established,to_client; content:".pdf|23|"; nocase; pcre:"/\x2Epdf\x23[^\r\n]+\x3Djavascript\x3A/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2007-0045; reference:url,isc.sans.org/diary.php?storyid=1999; classtype:misc-attack; sid:9842; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Plugin JavaScript parameter double free attempt"; flow:established,to_client; content:".pdf|23|"; nocase; content:"document."; distance:0; nocase; pcre:"/\x2Epdf\x23[^\r\n]+\x3Djavascript\x3A[^\r\n]*document\x2E\w+/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2007-0046; reference:url,www.adobe.com/support/security/advisories/apsa07-01.html; classtype:attempted-user; sid:9843; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Vector Markup Language recolorinfo tag numfills parameter buffer overflow attempt"; flow:established,to_client; content:"recolorinfo"; nocase; content:"numfills"; distance:0; nocase; content:"recolorinfoentry"; distance:0; nocase; content:"tocolor"; distance:0; nocase; pcre:"/<[pv]\x3Arecolorinfo\s+[^>]*numfills\s*=\s*(\x22[1-9]\d{4,}\x22|\x27[1-9]\d{7,}\x27)[^>]*>.*<[pv]\x3Arecolorinfoentry\s+[^>]*tocolor/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2007-0024; reference:url,www.microsoft.com/technet/security/bulletin/ms07-004.mspx; classtype:attempted-user; sid:9848; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Outlook Saved Search download attempt"; flow:established,to_client; flowbits:isset,http.xls; content:"S|00|a|00|v|00|e|00|d|00|S|00|e|00|a|00|r|00|c|00|h|00|"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2007-0034; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-003.mspx; classtype:attempted-user; sid:9847; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VLC Media Player udp URI format string attempt - single packet"; flow:to_client,established; content:"|23|EXTM3U"; content:"udp|3A|//"; distance:0; nocase; content:"%"; distance:0; pcre:"/\x23EXTM3U.*?udp\x3A\x2F\x2F[^\r\n]*%/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,21852; reference:cve,2007-0017; reference:url,projects.info-pull.com/moab/MOAB-02-01-2007.html; classtype:attempted-user; sid:9844; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VLC Media Player udp URI format string attempt - multipacket"; flow:to_client,established; flowbits:isset,http.m3u.download; content:"udp|3A|//"; nocase; content:"%"; distance:0; pcre:"/\x23EXTM3U.*?udp\x3A\x2F\x2F[^\r\n]*%/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,21852; reference:cve,2007-0017; reference:url,projects.info-pull.com/moab/MOAB-02-01-2007.html; classtype:attempted-user; sid:9846; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Vector Markup Language recolorinfo tag numcolors parameter buffer overflow attempt"; flow:established,to_client; content:"recolorinfo"; nocase; content:"numcolors"; distance:0; nocase; content:"recolorinfoentry"; distance:0; nocase; content:"tocolor"; distance:0; nocase; pcre:"/<[pv]\x3Arecolorinfo\s+[^>]*numcolors\s*=\s*(\x22[1-9]\d{4,}\x22|\x27[1-9]\d{7,}\x27)[^>]*>.*<[pv]\x3Arecolorinfoentry\s+[^>]*tocolor/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2007-0024; reference:url,www.microsoft.com/technet/security/bulletin/ms07-004.mspx; classtype:attempted-user; sid:9849; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT M3U File Download Detected"; flow:to_client,established; content:"|23|EXTM3U"; flowbits:set,http.m3u.download; flowbits:noalert; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; classtype:misc-activity; sid:9845; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Virtual Machine malformed GIF buffer overflow attempt"; flow:to_client,established; content:"GIF"; byte_test:1,!&,128,7,relative; content:","; within:1; distance:10; content:"|00 00|"; within:2; distance:4; metadata:policy security-ips drop; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:10062; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Firefox query interface suspicious function call access attempt"; flow:established,to_client; content:"location.QueryInterface"; nocase; content:"Components.interfaces.nsIClassInfo"; nocase; metadata:policy security-ips drop; reference:bugtraq,16476; reference:cve,2006-0295; reference:url,www.mozilla.org/security/announce/2006/mfsa2006-04.html; classtype:attempted-user; sid:10063; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT AIM GoChat URL access attempt"; flow:to_client,established; content:"aim|3A|GoChat?"; nocase; metadata:policy security-ips drop; reference:bugtraq,22146; reference:cve,2007-0021; reference:url,projects.info-pull.com/moab/MOAB-20-01-2007.html; classtype:misc-attack; sid:10116; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft WMF denial of service attempt"; flow:to_client,established; flowbits:isset,wmf.download; content:"|FC 02|"; pcre:"/\xFC\x02[\x08\x06]\x00.{4}(?!\x00\x00)/s"; metadata:policy security-ips drop; reference:bugtraq,21992; reference:cve,2006-4071; classtype:web-application-attack; sid:10115; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT mozilla compareTo arbitrary code execution attempt"; flow:from_server,established; content:"InstallVersion"; nocase; pcre:"/InstallVersion\s*\x29?\s*\.\s*compareTo/smi"; metadata:policy security-ips drop; reference:bugtraq,14242; reference:cve,2005-2265; reference:url,www.mozilla.org/security/announce/2005/mfsa2005-50.html; classtype:attempted-user; sid:10131; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Excel Malformed Named Graph Information unicode overflow"; flow:to_client,established; flowbits:isset,http.xls; content:"|95 00|"; isdataat:55,relative; pcre:"/^.{3}(\x00[^\x00]|[^\x00]\x00|[^\x00][^\x00]){25}/Rs"; metadata:policy security-ips drop; reference:cve,2007-0215; reference:url,www.microsoft.com/technet/security/bulletin/ms07-023.mspx; classtype:attempted-user; sid:11258; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT quicktime movie ftyp buffer underflow"; flow:to_client,established; flowbits:isset,http.quicktime; content:"|00 00 00 01|ftyp"; metadata:policy security-ips drop; reference:bugtraq,23642; reference:cve,2007-2296; classtype:attempted-user; sid:11180; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer colgroup tag uninitialized memory corruption vulnerability"; flow:to_client,established; content:"<colgroup"; nocase; content:"delete"; distance:0; nocase; pcre:"/<colgroup\s+[^>]*id\s*=\s*(?P<q1>\x22|\x27|)(?P<q2>\w+)(?P=q1)[^>]*>.*\s+(?P=q2)\.delete/smi"; metadata:policy security-ips drop; reference:bugtraq,23771; reference:cve,2007-0944; reference:url,www.microsoft.com/technet/security/bulletin/ms07-027.mspx; classtype:attempted-user; sid:11257; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop PNG file handling stack buffer overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"PLTE"; byte_test:4,>,768,-8,relative,big; metadata:policy security-ips drop; reference:bugtraq,23698; reference:cve,2007-2365; classtype:attempted-user; sid:11267; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Excel malformed named graph information ascii overflow"; flow:from_server,established; flowbits:isset,http.xls; content:"|95 00|"; isdataat:133,relative; pcre:"/^(.{92}[^\x00]{41}|.{148}[^\x00]{41}|.{172}[^\x00]{41}|.{212}[^\x00]{41}|.{252}[^\x00]{22}|.{272}[^\x00]{22}|.{292}[^\x00]{22}|.{312}[^\x00]{22}|.{332}[^\x00]{22})/Rs"; metadata:policy security-ips drop; reference:cve,2007-0215; reference:url,www.microsoft.com/technet/security/bulletin/ms07-023.mspx; classtype:attempted-user; sid:11290; rev:4;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT Windows schannel security package"; flow:established, to_client; flowbits:isset,sslv3.client_hello.request; content:"|16 03 00|"; content:"|0C|"; within:1; distance:2; byte_jump:2,3,relative,big; byte_jump:2,0,relative,big; content:"|00 00|"; within:2; reference:cve,2007-2218; reference:url,www.microsoft.com/technet/security/bulletin/MS07-031.mspx; classtype:attempted-user; sid:11947; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VML source file memory corruption"; flow:to_client,established; content:"stroke"; nocase; pcre:"/<(?P<t>[A-Z]+\x3A)\s*[^>]+>.*<[A-Z]+\x3A\s*stroke\s+[^>]*src\s*=\s*(?P<q>\x22|\x27|)[\w\x25\x2D\x2E]+(?P=q)[^>]*>.*?<\x2F/smi"; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-050.mspx; classtype:attempted-user; sid:12281; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Excel malformed FBI record"; flow:from_server,established; flowbits:isset,http.xls; content:"`|10|"; byte_test:2,>,32767,6,relative; reference:cve,2007-1203; reference:url,www.microsoft.com/technet/security/bulletin/ms07-023.mspx; classtype:attempted-user; sid:12256; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT xlw file download"; flow:to_client,established; content:"|09 08 10 00 00 06 00 01|"; flowbits:set,xlw.download; flowbits:noalert; reference:url,sc.openoffice.org/excelfileformat.pdf; classtype:misc-activity; sid:12283; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT PCRE character class double free overflow attempt"; flow:to_client,established; content:"RegExp"; nocase; content:"[["; content:"]"; distance:1; pcre:"/(\w+)\s*=\s*('|")[^\2]*\[\[[^\2]*\][^\2]*\2\s*\;.*new\s+RegExp\s*\(\s*\1|new\s+RegExp\(('|")[^\3]*\[\[[^\3]*\]/Osmi"; reference:bugtraq,25002; reference:cve,2007-3944; reference:url,docs.info.apple.com/article.html?artnum=306174; classtype:attempted-user; sid:12286; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS tag memory corruption attempt"; flow:to_client,established; pcre:"/\x3c[^\x3e]*style=[^\x3e]*csstext\x3a.*\x3e/i"; reference:bugtraq,24423; reference:cve,2007-1750; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-033.mspx; classtype:attempted-user; sid:11966; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT SMIL RealPlayer wallclock parsing buffer overflow"; flow:to_client,established; content:"smil "; nocase; content:"wallclock|28|"; distance:0; nocase; pcre:"/wallclock\x28((\d{2}\x3A){2}\d{2}\.\d{11,}|\d{4}-\d{2}-\d{2}T(\d{2}\x3A){2}\d{2}\.\d{11,})/smi"; reference:bugtraq,24658; reference:cve,2007-3410; reference:url,labs.idefense.com/intelligence/vulnerabilities/display.php?id=547; classtype:attempted-user; sid:12219; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VML source file memory corruption"; flow:to_client,established; content:"imagedata"; nocase; pcre:"/<(?P<t>[A-Z]+\x3A)\s*[^>]+>.*<[A-Z]+\x3A\s*imagedata\s+[^>]*src\s*=\s*(?P<q>\x22|\x27|)[\w\x25\x2D\x2E]+(?P=q)[^>]*>.*?<\x2F/smi"; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-050.mspx; classtype:attempted-user; sid:12280; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft XML substringData integer overflow attempt"; flow:to_client,established; content:"substringData"; nocase; pcre:"/\w+\.substringData\([^\),]+,\s*(\d{4,}|25[7-9]|2[6-9][0-9]|[3-9][0-9]{2}|0x0*([1-9a-f][1-9a-f]{3,}|[2-9a-f][0-9a-f]{2}|1([0-9a-f][0-9a-f]|0[1-9a-f])))/smi"; metadata:policy security-ips drop, service http; reference:cve,2007-2223; reference:cve,2007-2224; reference:cve,2008-1442; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-042.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-043.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-031.mspx; classtype:attempted-user; sid:12279; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VML source file memory corruption"; flow:to_client,established; content:"vmlframe"; nocase; pcre:"/<(?P<t>[A-Z]+\x3A)\s*[^>]+>.*<[A-Z]+\x3A\s*vmlframe\s+[^>]*src\s*=\s*(?P<q>\x22|\x27|)[\w\x25\x2D\x2E]+(?P=q)[^>]*>.*?<\x2F/smi"; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-050.mspx; classtype:attempted-user; sid:12282; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Excel rtWnDesk record memory corruption exploit attempt"; flow:to_client,established; content:"8|00 04 00|"; byte_test:2,>,32767,0,relative,little; flowbits:isset,xlw.download; reference:cve,2007-3890; reference:url,www.microsoft.com/technet/security/Bulletin/ms07-044.mspx; classtype:attempted-user; sid:12284; rev:1;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT Excel Workspace file download"; flow:from_server,established; content:"|09|"; content:"|00 00|"; within:2; distance:2; content:"|00 01|"; within:2; distance:1; pcre:"/\x09[\x00\x02\x04\x08][\x06\x08\x10]\x00\x00[\x04\x05\x06]\x00\x01/s"; flowbits:set,xlw.download; flowbits:noalert; reference:url,sc.openoffice.org/excelfileformat.pdf; classtype:misc-activity; sid:12285; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Visual Basic VBP file reference overflow attempt"; flow:established,from_server; content:"Reference"; nocase; pcre:"/^Reference\s*=\s*\*\x5CG\{[A-Z\d-]{36}\}\x23\d+\.\d+\x23\d+\x23[^\r\n]{474}/smi"; reference:bugtraq,25629; reference:cve,2007-4776; classtype:attempted-user; sid:12618; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT URI External handler arbitrary command attempt"; flow:established, to_client; content:"%00%00"; pcre:"/(mailto|telnet|news|nntp|snews)\x3A%00%00/i"; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/bulletin/ms07-061.mspx; classtype:attempted-user; sid:12643; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ShellExecute and IE7 url handling code execution attempt"; flow:to_client,established; content:"|22|.cmd"; nocase; pcre:"/(mailto|telnet|news|nntp|snews)\x3A[^\n]*\x25[^\n]*\x22\x2Ecmd/i"; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-057.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-061.mspx; classtype:attempted-user; sid:12688; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ShellExecute and IE7 url handling code execution attempt"; flow:to_client,established; content:"|22|.bat"; nocase; pcre:"/(mailto|telnet|news|nntp|snews)\x3A[^\n]*\x25[^\n]*\x22\x2Ebat/i"; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-057.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-061.mspx; classtype:attempted-user; sid:12687; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer lyrics heap overflow attempt"; flow:established,to_client; content:"LYRICSBEGIN"; nocase; pcre:"/(EAL|EAR|ETT)\s*-0{0,4}1/i"; reference:bugtraq,26214; reference:cve,2007-5080; classtype:attempted-user; sid:12707; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks SMIL wallclock stack overflow attempt"; flow:established,to_client; content:"<smi"; nocase; content:"wallclock|28|"; pcre:"/^[^\x29]*\x2E[0-9]{11}/R"; metadata:policy balanced-ips drop, policy security-ips drop, service sunrpc; reference:bugtraq,24658; reference:cve,2007-3410; classtype:attempted-user; sid:12728; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FLAC libFLAC picture description metadata buffer overflow attempt"; flow:to_client,established; content:"fLaC"; content:"|06|"; byte_jump:4,7,relative; content:"|FF FF FF FF|"; within:4; metadata:policy security-ips drop, service http; reference:bugtraq,26042; reference:cve,2007-4619; classtype:attempted-user; sid:12743; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime uncompressed PICT stack overflow attempt"; flow:to_client,established; content:"|00 00 00 00 00 00 00 00 00 00|"; content:"|00 11 02 FF|"; distance:0; fast_pattern; content:"|82 01|"; distance:0; byte_test:4,<,50,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26344; reference:cve,2007-4672; classtype:attempted-user; sid:12757; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FLAC libFLAC picture metadata buffer overflow attempt"; flow:to_client,established; content:"fLaC"; content:"|06|"; content:"|FF FF FF FF|"; within:4; distance:7; metadata:policy security-ips drop, service http; reference:bugtraq,26042; reference:cve,2007-4619; classtype:attempted-user; sid:12745; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FLAC libFLAC VORBIS string buffer overflow attempt"; flow:to_client,established; content:"fLaC"; content:"|04|"; content:"|FF FF FF FF|"; within:4; distance:3; metadata:policy security-ips drop, service http; reference:bugtraq,26042; reference:cve,2007-4619; classtype:attempted-user; sid:12744; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Media Player .asf markers detected"; flow:to_client, established; content:"|01 CD 87 F4|Q|A9 CF 11 8E E6 00 C0 0C| Se"; content:" |DB FE|L|F6|u|CF 11 9C 0F 00 A0 C9 03|I|CB|"; within:16; distance:8; metadata:policy balanced-ips alert, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-068.mspx; classtype:attempted-user; sid:12972; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB_CLIENT Microsoft Media Player asf streaming format audio error masking integer overflow attempt"; flow:established, to_client; content:"49F1A440-4ECE-11d0-A3AC-00A0C90348F6"; byte_jump:4, 8, relative; byte_test:2, >, 65527, 14, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-068.mspx; classtype:attempted-user; sid:13159; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsft Media Player asf streaming audio spread error correction data length integer overflow attempt"; flow:established, to_client; content:"BFC3CD50-618F-11CF-8BB2-00AA00B4E220"; byte_test:4, >, 65522, 12, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-068.mspx; classtype:attempted-user; sid:13160; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB_CLIENT Microsoft Media Player asf streaming format interchange data integer overflow attempt"; flow:established, to_client; content:"35907DE0-E415-11CF-A917-00805F5C442B"; byte_test:2, >, 65476, 52, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-068.mspx; classtype:attempted-user; sid:13158; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT QuickTime panorama atoms buffer overflow attempt"; flow:to_client,established; content:"video/quicktime"; nocase; content:"pdat"; byte_test:2,=,0,6,relative; byte_test:4,>,104,-8,relative; metadata:policy security-ips drop, service http; reference:bugtraq,26342; reference:cve,2007-4675; reference:url,docs.info.apple.com/article.html?artnum=306896; classtype:attempted-user; sid:13293; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing des buffer overflow attempt"; flow:to_client, established; flowbits:isset,http.mp4; content:"|A9|des"; byte_test:4, >, 512, 0, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26773; reference:cve,2007-6401; classtype:attempted-user; sid:13319; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing ART buffer overflow attempt"; flow:to_client, established; flowbits:isset,http.mp4; content:"|A9|ART"; byte_test:4, >, 512, 0, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26773; reference:cve,2007-6401; classtype:attempted-user; sid:13316; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing cmt buffer overflow attempt"; flow:to_client, established; flowbits:isset,http.mp4; content:"|A9|cmt"; byte_test:4, >, 512, 0, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26773; reference:cve,2007-6401; classtype:attempted-user; sid:13318; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apache mod_imagemap cross site scripting attempt"; flow:to_server,established; uricontent:".map/"; nocase; pcre:"/.map/[^\n]*script[^\n]*script/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26838; reference:cve,2007-5000; classtype:web-application-attack; sid:13302; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing cpy buffer overflow attempt"; flow:to_client, established; flowbits:isset,http.mp4; content:"|A9|cpy"; byte_test:4, >, 512, 0, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26773; reference:cve,2007-6401; classtype:attempted-user; sid:13320; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing nam buffer overflow attempt"; flow:to_client, established; flowbits:isset,http.mp4; content:"|A9|nam"; byte_test:4, >, 512, 0, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26773; reference:cve,2007-6401; classtype:attempted-user; sid:13317; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player embedded JPG image height overflow attempt"; flow:to_client, established; content:"FWS"; content:"|FF D8|"; distance:0; content:"JFIF"; distance:0; content:"|FF C0|"; distance:0; byte_test:2, >, 32767, 3, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26951; reference:cve,2007-6242; classtype:attempted-admin; sid:13300; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player embedded JPG image width overflow attempt"; flow:to_client, established; content:"FWS"; content:"|FF D8|"; distance:0; content:"JFIF"; distance:0; content:"|FF C0|"; distance:0; byte_test:2, >, 32767, 5, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26951; reference:cve,2007-6242; classtype:attempted-admin; sid:13301; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Works file download request"; flow:to_server, established; content:"GET"; nocase; http_method; uricontent:".wps"; nocase; flowbits:set, works.download; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:13465; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Quicktime user agent"; flow:to_server, established; content:"User-Agent|3A| QuickTime"; flowbits:set,quicktime_agent; flowbits:noalert; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:misc-activity; sid:13515; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Quicktime HTTP error response buffer overflow"; flow:to_client, established; flowbits:isset, quicktime_agent; content:"HTTP/1.1 404"; isdataat:256,relative; content:!"|0A|"; within:256; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28423; reference:cve,2008-0234; classtype:attempted-user; sid:13516; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft SYmbolic LinK file download request"; flow:to_server, established; uricontent:".slk"; nocase; pcre:"/^[^\?]*\.slk([\?\x5c\x2f]|$)/Usi"; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy security-ips alert, service http; reference:cve,2008-0112; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-014.mspx; classtype:misc-activity; sid:13583; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft SYmbolic LinK file download"; flow:to_client,established; content:"ID|3B|P"; nocase; flowbits:isset,csv.download; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy security-ips alert, service http; reference:cve,2008-0112; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-014.mspx; classtype:misc-activity; sid:13585; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT csv file download request"; flow:to_server, established; content:"GET"; nocase; http_method; uricontent:".csv"; nocase; flowbits:set,csv.download; flowbits:noalert; metadata:service http; reference:cve,2008-0112; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-014.mspx; classtype:misc-activity; sid:13584; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Access file download request"; flow:to_server, established; content:"GET"; nocase; uricontent:".mdb"; nocase; metadata:service http; reference:url,support.microsoft.com/kb/925330; classtype:misc-activity; sid:13628; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Zango adware installation request"; flow:to_server, established; uricontent:"Zango/Setup.exe"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:url,www.ftc.gov/os/caselist/0523130/index.shtm; classtype:policy-violation; sid:13632; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Access file download request"; flow:to_server, established; content:"GET"; nocase; uricontent:".mdb"; nocase; flowbits:set,access.download; flowbits:noalert; metadata:service http; reference:url,support.microsoft.com/kb/925330; classtype:misc-activity; sid:13627; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows metafile SetPaletteEntries heap overflow attempt"; flow:established,to_client; flowbits:isset,wmf.download; content:"|00 09 00|"; content:"|FF FF FF|"; distance:12; content:"|00|"; within:1; distance:2; pcre:"/[\x00\x01]\x00\x09\x00.*\xff\xff\xff[\xff\xf7][\x36\x37]\x00/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,15356; reference:cve,2005-2124; reference:url,www.microsoft.com/technet/security/bulletin/ms05-053.mspx; classtype:attempted-user; sid:13807; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RTF file download"; flow:established,to_client; content:"Content-Type|3A|"; nocase; http_header; content:"text/rtf"; fast_pattern; http_header; flowbits:set,http.rtf; flowbits:noalert; metadata:service http; classtype:protocol-command-decode; sid:13801; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IBM Lotus Expeditor cai URI Handler Command Execution attempt"; flow:to_client,established; content:"cai|3A|"; nocase; pcre:"/\x3c[^\x3e]+((\x22cai\x3a[^\x3e]*\x2522[^\x3e\x22]*-launcher[^\x3e\x22]*\x22)|(\x27cai\x3a[^\x3e]*(\x2522|\x22)[^\x3e\x27]*-launcher[^\x3e\x27]*\x27)|(cai\x3a[^\x3e]*(\x2522|\x22)[^\x3e]*-launcher[^\x3e]*\s+))\s*\x3e/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-1965; classtype:attempted-admin; sid:13799; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash player SWF scene and label data memory corruption attempt"; flow:to_client,established; content:"|BF 15 84 03 00 00|"; content:"|BF 14|D|02 00 00|"; within:6; distance:900; content:"?|13 1F 00 00 00|"; within:6; distance:640; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13821; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash player SWF scene and label data memory corruption attempt"; flow:to_client,established; content:"|A8 15|"; content:"|8C 15|"; within:2; distance:40; content:"|BF 14 7F 01 00 00|"; within:6; distance:12; content:"|19 13|"; within:2; distance:383; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13822; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash player SWF scene and label data memory corruption attempt"; flow:to_client,established; content:"|A8 15|"; content:"|BF 15 0C 00 00 00|"; within:6; distance:45; content:"|BF 14 7F 01 00 00|"; within:6; distance:12; content:"?|13 19 00 00 00|"; within:6; distance:383; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13820; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox IFRAME style change handling code execution"; flow:from_server,established; content:"iframe"; nocase; content:"iframe.contentDocument.designMode"; nocase; content:"addEventListener"; nocase; pcre:"/addEventListener\s*\(\s*(?P<q>\x22|\x27|)(mouse(move|down)|keydown)(?P=q)/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,28448; reference:cve,2008-1236; reference:url,secunia.com/advisories/29526; reference:url,www.mozilla.org/security/announce/2008/mfsa2008-15.html; classtype:attempted-user; sid:13838; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe BMP image handler buffer overflow attempt"; flow:to_client, established; flowbits:isset,http.bmp; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4, >, 256, 36, relative, little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28874; reference:cve,2008-1765; classtype:attempted-user; sid:13865; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft search file download attempt"; flow:to_server,established; uricontent:"search-ms"; nocase; flowbits:set,mssearch_file.request; classtype:misc-activity; sid:13911; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime MOV file string handling integer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"hdlr"; byte_test:1,>=,251,24,relative; metadata:policy security-ips drop, service http; reference:bugtraq,15306; reference:cve,2005-2753; classtype:attempted-user; sid:13917; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime MOV file string handling integer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"text"; byte_test:1,>=,251,49,relative; metadata:policy security-ips drop, service http; reference:bugtraq,15306; reference:cve,2005-2753; classtype:attempted-user; sid:13919; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime MOV file string handling integer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"tmci"; byte_test:1,>=,251,24,relative; metadata:policy security-ips drop, service http; reference:bugtraq,15306; reference:cve,2005-2753; classtype:attempted-user; sid:13918; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime Obji Atom parsing stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"obji"; nocase; byte_test:4,<,20,-8,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28583; reference:cve,2008-1022; classtype:attempted-user; sid:13920; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sun Java Web Start JNLP attribute buffer overflow attempt"; flow:established, to_client; content:"<j2se"; nocase; pcre:"/\x3cj2se[^\x3e]*(initial|max)-heap-size\s*\x3d\s*(\x22|\x27)[^\2]{50}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30148; reference:cve,2008-3111; classtype:attempted-user; sid:13950; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Office eps file download"; flow:established, to_server; uricontent:".eps"; nocase; flowbits:set, http.eps.download; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:13983; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Powerpoint file download attempt"; flow:to_server,established; uricontent:".ppt"; nocase; flowbits:set,ppt.download; flowbits:noalert; metadata:policy balanced-ips alert, policy security-ips alert, service http; classtype:misc-activity; sid:13982; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT CyberLink PowerDVD playlist file handling stack overflow attempt"; flow:to_client, established; flowbits:isset,http.m3u.download; content:"Content-Length|3A| "; nocase; http_header; byte_test:8,>,516284,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30341; classtype:attempted-user; sid:14019; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT CyberLink PowerDVD playlist file handling stack overflow attempt"; flow:to_client, established; flowbits:isset,http.pls.download; content:"Content-Length|3A| "; nocase; http_header; byte_test:8,>,516284,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30341; classtype:attempted-user; sid:14020; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT MPEG Layer 3 playlist file request"; flow:to_server, established; uricontent:".m3u"; nocase; flowbits:set, http.m3u.download; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:14017; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT PLS multimedia playlist file request"; flow:to_server, established; uricontent:".pls"; nocase; flowbits:set, http.pls.download; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:14018; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Reader and Acrobat util.printf buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/S/JavaScript/JS"; nocase; content:"util.printf"; pcre:"/\x28\s*\x22\s*\x25([2-9][6-9][5-9]|[1-9][0-9]{3,})f/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2008-2992; classtype:attempted-user; sid:15014; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sun Java Web Start xml encoding buffer overflow attempt"; flow:established,to_client; content:"<?xml"; nocase; content:"encoding"; distance:0; nocase; pcre:"/^<\x3Fxml[^>]+?encoding\s*=\s*(\x22[^\x22]{28,63}\x22|\x27[^\x27]{28,63}\x27)/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,28083; reference:cve,2008-1188; reference:url,sunsolve.sun.com/search/document.do?assetkey=1-66-233323-1; classtype:attempted-admin; sid:15081; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Rich Text Format file request"; flow:to_server, established; uricontent:".rtf"; nocase; flowbits:set,http.rtf; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:15123; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Internet Explorer nested span tag memory corruption attempt"; flow:established,to_client; content:"<span"; nocase; content:"datasrc"; distance:0; nocase; content:"datafld"; nocase; pcre:"/<span\s+[^>]*(datasrc\s*=\s*(?P<q1>\x22|\x27|)(?P<d1>[^\s]+)(?P=q1)\s+[^>]*datafld\s*=\s*(?P<q2>\x22|\x27|)(?P<d2>[^\s]+)(?P=q2)|datafld\s*=\s*(?P<q3>\x22|\x27|)([^\s]+)(?P=q3)\s+[^>]*datasrc\s*=\s*(?P<q4>\x22|\x27|)([^\s]+)(?P=q4))[^>]*>.*?(?<!<\/span>)<span\s+[^>]*(datasrc\s*=\s*(?P<q5>\x22|\x27|)(?P=d1)(?P=q5)\s+datafld\s*=\s*(?P<q6>\x22|\x27|)(?P=d2)(?P=q6)|(datafld\s*=\s*(?P<q7>\x22|\x27|)(?P=d1)(?P=q7)\s+datasrc\s*=\s*(?P<q8>\x22|\x27|)(?P=d2)(?P=q8)))/Osmi"; metadata:policy balanced-ips alert, policy security-ips drop, service http; reference:bugtraq,32721; reference:cve,2008-4844; reference:url,www.microsoft.com/technet/security/bulletin/ms08-078.mspx; classtype:attempted-user; sid:15126; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player XSPF memory corruption attempt"; flow:to_client,established; flowbits:isset,xspf_file.request; content:"<identifier>"; byte_test:1,=,45,0,relative; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2008-4558; classtype:attempted-user; sid:15157; rev:2;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player RealText buffer overflow attempt"; flow:to_client,established; flowbits:isset,realplayer.playlist; content:"<time "; nocase; pcre:"/\x3ctime\x20[^\x3e]*(begin|end)\x3d\x22[^\x22]{13}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-5036; classtype:attempted-user; sid:15166; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ACD Systems ACDSee XPM file format overflow attempt"; flow:to_client,established; content:"/* XPM */"; pcre:"/^\s*\x22[^\x22\n]{300}/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,23620; reference:cve,2007-2193; classtype:attempted-user; sid:15236; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Visio file download request"; flow:to_server, established; content:"GET"; nocase; http_method; uricontent:".vsd"; nocase; flowbits:set, visio.request; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:15294; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Portable Executable binary file transfer"; flow:to_client,established; content:"MZ|90 00|"; byte_jump:4,56,relative,little; content:"PE|00 00|"; within:4; distance:-64; flowbits:set,exe.download; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:15306; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe PDF JBIG2 remote code execution attempt"; flow:to_client, established; content:"JBIG2Decode"; nocase; content:"stream"; distance:0; pcre:"/JBIG2Decode.*?stream(\x0d\x0a|\x0a|\x0d)/smi"; byte_test:1, &, 64, 4, relative; byte_test:1, <, 160, 5, relative; byte_test:4, >, 35256, 6, relative,little; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15357; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT obfuscated javascript excessive fromCharCode - potential attack"; flow:established,to_client; content:"String.fromCharCode|28|"; nocase; content:"String.fromCharCode|28|"; within:100; nocase; content:"String.fromCharCode|28|"; within:100; nocase; content:"String.fromCharCode|28|"; within:100; nocase; content:"String.fromCharCode|28|"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.cs.ucsb.edu/~marco/blog/2008/10/dom-based-obfuscation-in-malicious-javascript.html; classtype:misc-activity; sid:15362; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Potential obfuscated javascript eval unescape attack attempt"; flow:established,to_client; content:"eval|28|"; nocase; content:"unescape|28|"; within:15; nocase; content:!"|29|"; within:250; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.cs.ucsb.edu/~marco/blog/2008/10/dom-based-obfuscation-in-malicious-javascript.html; classtype:misc-activity; sid:15363; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime pict image poly structure memory corruption attempt"; flow:established,to_client; content:"|00 11 02 FF 0C 00|"; pcre:"/\x00[\x70-\x74]\x00[\x00-\x09]/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26345; reference:bugtraq,34938; reference:cve,2007-4676; reference:cve,2009-0010; classtype:attempted-user; sid:15384; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT OLE32 microsoft MSHTA masquerade attempt"; flow:to_client,established; flowbits:isnotset,http.hta; content:"R|00|o|00|o|00|t|00| |00|E|00|n|00|t|00|r|00|y|00|"; nocase; content:"|D8 F4|P0|B5 98 CF 11 BB 82 00 AA 00 BD CE 0B|"; within:16; distance:60; metadata:policy security-ips drop; reference:bugtraq,13132; reference:cve,2005-0063; reference:url,www.microsoft.com/technet/security/bulletin/ms05-016.mspx; classtype:attempted-user; sid:3552; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HTML DOM null DHTML element insertion attempt"; flow:to_client,established; content:"NULL"; pcre:"/(insertBefore|insertAfter|appendChild)\(\s*NULL\s*\)/sm"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:3553; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Content Advisor attempted overflow"; flow:from_server,established; content:"PICS-version"; nocase; pcre:"/PICS-version\s+(\d{1,}|\d(\x2e\d){1,})\s*\x29\s+/smi"; pcre:"/\x28\s*rating-system\s*\S+\s*\x29\s+/smi"; pcre:"/\x28\s*rating-service\s*\S+\s*\x29\s+/smi"; pcre:"/\x28\s*name\s*\x22[^\x22]{260,}/smi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,13117; reference:cve,2005-0555; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:3686; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft EMF+ GpFont.SetData buffer overflow attempt"; flow:established,to_client; content:"|01 00 00 00|"; content:" EMF"; within:4; distance:36; byte_jump:4,-40,relative,little; content:"F|00 00 00|,|00 00 00| |00 00 00|"; within:12; distance:-8; content:"F|00 00 00|"; distance:0; content:"|08|@|00 06|"; within:4; distance:12; byte_test:4,>,4261412864,28,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34250; reference:cve,2009-1217; classtype:attempted-user; sid:15430; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT MAKI file request"; flow:to_server,established; uricontent:".maki"; nocase; flowbits:set,maki_file.request; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:15426; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox SVG data processing memory corruption attempt"; flow:to_client,established; flowbits:isset,svg_file.request; content:"<script"; content:".getElementsByTagName"; distance:1; content:"path"; distance:1; content:".pathSegList"; distance:1; content:"createSVGPathSegMoveto"; distance:1; content:".appendItem"; distance:1; content:".replaceItem"; distance:1; content:"</script"; distance:1; pcre:"/(?P<N1>[a-zA-Z\x5f][a-zA-Z\x5f0-9]*\x2e)appendItem(?!.+?(?P=N1)appendItem).+?(?P=N1)replaceItem/s"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33990; reference:cve,2009-0771; reference:url,www.mozilla.org/security/announce/2009/mfsa2009-07.html; classtype:attempted-user; sid:15428; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Excel file request"; flow:to_server,established; uricontent:".xls"; nocase; flowbits:set,excel.download; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy security-ips alert, service http; classtype:misc-activity; sid:15463; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Excel file request"; flow:to_server,established; uricontent:".xlw"; nocase; flowbits:set,excel.download; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy security-ips alert, service http; classtype:misc-activity; sid:15464; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp pls file player name handling buffer overflow attempt"; flow:to_client,established; content:"[playlist]"; nocase; content:"File"; distance:0; nocase; content:"="; within:5; distance:1; isdataat:500,relative; content:!"|0A|"; within:500; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,16410; reference:cve,2006-0476; classtype:attempted-user; sid:15472; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT asp file upload"; flow:to_server,established; content:".asp"; nocase; flowbits:set,asp.upload; flowbits:noalert; metadata:policy balanced-ips alert, policy security-ips alert, service http; classtype:misc-activity; sid:15471; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp m3u file player name handling buffer overflow attempt"; flow:to_client,established; content:"|23|EXTM3U"; nocase; pcre:"/^[^\x0a]{501}/m"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,16410; reference:cve,2006-0476; classtype:attempted-user; sid:15473; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Trend Micro OfficeScan Server cgiRecvFile overflow attempt"; flow:to_server,established; uricontent:"/cgi/cgiRecvFile.exe"; content:"ComputerName"; pcre:"/ComputerName\s*\x3d\s*\x22[^\x22]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,31139; reference:cve,2008-2437; classtype:attempted-admin; sid:15510; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT AVI multimedia file request"; flow:to_server,established; uricontent:".avi"; nocase; flowbits:set,avi.download; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy security-ips alert, service http; classtype:misc-activity; sid:15516; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime Movie File Clipping Region handling heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"crgn"; byte_jump:2,-6,relative,big; content:!"|7F FF 7F FF|"; within:4; distance:-8; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35167; reference:cve,2009-0954; reference:url,support.apple.com/kb/HT3591; classtype:attempted-user; sid:15559; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Reader JPX malformed code-block width attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"jP  "; content:"|FF|O|FF|Q"; distance:0; byte_jump:2,36,relative,multiplier 3,big; content:"|FF|R"; within:2; byte_test:1,>,16,7,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1859; classtype:attempted-user; sid:15562; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT WordPerfect file download"; flow:to_client,established; content:"|0A FF|WPC"; content:"|01 0A 02 01|"; within:4; distance:4; metadata:service http; reference:url,www.corelconnected.com/html/files/WPFF_%21DocumentStructure.htm; classtype:misc-activity; sid:15575; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT F-Secure AntiVirus library heap overflow attempt"; flow:to_client,established; flowbits:isset,arj_file.request; content:"|0A|`|EA|"; pcre:"/\x0a\x0d?\x0a\x60\xea(.{36}[^\x00]{256}|.+\x60\xea.{32}[^\x00]{256})/s"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,12515; reference:cve,2005-0350; classtype:attempted-user; sid:15583; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Excel file download request"; flow:established, to_server; uricontent:".xls"; nocase; flowbits:set,http.xls; flowbits:noalert; metadata:policy balanced-ips alert, policy security-ips alert, service http; classtype:protocol-command-decode; sid:15585; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Word file download request"; flow:established, to_server; uricontent:".doc"; nocase; flowbits:set,http.doc; flowbits:noalert; metadata:policy balanced-ips alert, policy security-ips alert, service http; classtype:protocol-command-decode; sid:15587; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Powerpoint file download request"; flow:established, to_server; uricontent:".ppt"; nocase; flowbits:set,http.ppt; flowbits:noalert; metadata:policy balanced-ips alert, policy security-ips alert, service http; classtype:protocol-command-decode; sid:15586; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Possible generic javascript heap spray attempt"; flow:to_client,established; content:"%u0c0c%u0c0c"; nocase; metadata:policy security-ips drop, service http; reference:bugtraq,35660; classtype:attempted-user; sid:15698; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Generic javascript obfuscation attempt"; flow:to_client,established; content:"unescape"; nocase; pcre:"/var[^=]+=\s*unescape\s*\x3b/i"; metadata:policy security-ips drop, service http; reference:bugtraq,35660; classtype:attempted-user; sid:15697; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes PCAST protocol handler stack buffer overflow attempt"; flow:to_client,established; content:"pcast|3A|//"; nocase; pcre:"/(\x22|\x27)pcast\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15705; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes ITMS protocol handler stack buffer overflow attempt"; flow:to_client,established; content:"itms|3A|//"; nocase; pcre:"/(\x22|\x27)itms\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15703; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat and Adobe Reader FlateDecode integer overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/DecodeParms"; content:"/Predictor"; distance:0; byte_test:8,>,1,0,relative,string,dec; pcre:"/\x2fDecodeParms\s*\x3c{2}\s*(?=[^\x3e]*/Predictor\s+0*(1\d{1}|[2-9]))([^\x3e]*\x2fBitsPerComponent\s+\d{3}|[^\x3e]*\x2fColumns\s+\d{4}|[^\x3e]*\x2fColors\s+\d{4})/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35294; reference:bugtraq,36600; reference:cve,2009-1856; reference:cve,2009-3459; classtype:attempted-user; sid:15709; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes ITPC protocol handler stack buffer overflow attempt"; flow:to_client,established; content:"itpc|3A|//"; nocase; pcre:"/(\x22|\x27)itpc\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15707; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes DAAP protocol handler stack buffer overflow attempt"; flow:to_client,established; content:"daap|3A|//"; nocase; pcre:"/(\x22|\x27)daap\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15706; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes ITMSS protocol handler stack buffer overflow attempt"; flow:to_client,established; content:"itmss|3A|//"; nocase; pcre:"/(\x22|\x27)itmss\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15704; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Firefox defineSetter function pointer memory corruption attempt"; flow:established,to_client; content:".watch|28|"; nocase; content:"__defineSetter__|28|"; nocase; pcre:"/(?P<obj>\w+)\.watch\((?P<q1>\x22|\x27|)(?P<prop>[A-Z0-9\x2d\x5f]+)(?P=q1).*(?P=obj)\.__defineSetter__\((?P<q2>\x22|\x27|)(?P=prop)(?P=q2)/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,35758; reference:cve,2009-2469; classtype:attempted-user; sid:15872; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat PDF font processing memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"obj<<"; content:"/BaseFont"; distance:0; content:"endobj"; distance:0; pcre:"/obj\x3c\x3c.*?\x2fBaseFont\x2f(?![A-Za-z0-9\x23\x2b\x2c\x2d\x2e\x5f]+(\s|\x2f|\x3e\x3e)).*?endobj/s"; metadata:policy security-ips drop, service http; reference:bugtraq,32100; reference:cve,2008-4813; reference:url,vallejo.cc/proyectos/adobereader812.html; classtype:attempted-user; sid:15867; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT libxml2 XML file processing long entity name buffer overflow attempt"; flow:to_client,established; content:"<!ENTITY"; pcre:"/\x3c\x21ENTITY\s*[^\s\x3e]{200}/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,31126; reference:cve,2008-3529; classtype:attempted-user; sid:15866; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT MP4 file request"; flow:to_server,established; uricontent:".mp4"; nocase; flowbits:set,http.mp4; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:15865; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FFmpeg 4xm processing memory corruption attempt"; flow:to_client,established; flowbits:isset,4xm.request; content:"strk|28 00 00 00|"; byte_test:4,>,0x7ffffffe,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33502; reference:cve,2009-0385; classtype:attempted-user; sid:15871; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Firefox location spoofing via invalid window.open characters"; flow:established,to_client; content:"window.open|28|"; nocase; pcre:"/window\x2Eopen\x28(\x22[^\x22]+(\x25[^0-9a-f]|\x2C)|\x27[^\x27]+(\x25[^0-9a-f]|\x2C))/smi"; metadata:policy security-ips alert, service http; reference:bugtraq,35803; reference:cve,2009-2654; classtype:misc-attack; sid:15873; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player ASnative command execution attempet"; flow:to_client, established; content:"|00|airappinstaller|00|ASnative|00|"; pcre:"/\x00[\x3b\x7c\x26\x60][^\x00]+\x00airappinstaller\x00ASnative\x00/smi"; content:"|99 08|"; distance:0; metadata:policy security-ips drop, service http; reference:bugtraq,32896; reference:cve,2008-5499; classtype:attempted-user; sid:15869; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT fCreateShellLink function use - potential attack"; flow:established,to_client; content:"fCreateShellLink|28|"; nocase; metadata:service http; reference:bugtraq,29792; reference:cve,2008-2959; classtype:misc-activity; sid:15893; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime VR Track Header Atom heap corruption attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"trak"; content:"tkhd"; within:4; distance:4; fast_pattern; pcre:"/trak.{4}tkhd.{40}(?!\x00\x01\x00\x00.{12}\x00\x01\x00\x00)/s"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33384; reference:cve,2009-0002; reference:url,support.apple.com/kb/HT3403; classtype:attempted-user; sid:15909; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft media format file download request"; flow:to_server, established; uricontent:".wma"; nocase; flowbits:set,http.wma; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:15921; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT mp3 file download request"; flow:to_server, established; uricontent:".mp3"; nocase; flowbits:set,http.mp3; flowbits:noalert; metadata:policy balanced-ips alert, policy security-ips alert, service http; classtype:misc-activity; sid:15922; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Internet Explorer URL canonicalization address bar spoofing attempt"; flow:established,to_client; content:"%01@"; pcre:"/http\x3A\x2f\x2f[^\r\n]+\x2501\x40/smi"; metadata:service http; reference:cve,2003-1025; reference:url,www.microsoft.com/technet/security/bulletin/ms04-004.mspx; classtype:misc-activity; sid:15933; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sophos Anti-Virus zip file handling DoS attempt"; flow:to_client,established; content:"PK|03 04|"; content:"|0C 00|"; within:2; distance:4; content:"-|00 00 00 F9 00 00 00 05 00 FF FF|"; within:12; distance:8; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,14270; reference:cve,2005-1530; classtype:attempted-dos; sid:15957; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vista Feed Headlines Gagdet code execution attempt"; flow:to_client,established; flowbits:isset,rss.download; content:"&lt|3B|"; fast_pattern; nocase; content:"<title>"; nocase; pcre:"/\x3ctitle\x3e[^\x3c]*\x26lt\x3b[^\x3c]*(>|\x26gt\x3b)/i"; metadata:policy security-ips drop, service http; reference:bugtraq,25287; reference:cve,2007-3033; classtype:attempted-user; sid:15946; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT RSS file download request"; flow:to_server,established; uricontent:".rss"; nocase; flowbits:set,rss.download; flowbits:noalert; metadata:policy security-ips alert, service http; classtype:misc-activity; sid:15945; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla regular expression heap corruption attempt"; flow:established,to_client; content:"new RegExp|28|"; nocase; pcre:"/^(?=[^\x29]*\x5c{2}[\x22\x27])[^\x29]*\x5b[^\x5d]*\x5c{2}[\x22\x27]/R"; metadata:policy security-ips drop, service http; reference:bugtraq,20042; reference:cve,2006-4566; classtype:attempted-user; sid:8443; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sun Microsystems Java gif handling memory corruption attempt"; flow:to_client,established; content:"|F9 04 01 00 00 10 00|,|00 00 00 00 00 00 90 01|"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:16000; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT midi file download attempt"; flow:to_client,established; content:"Content-Type|3A|"; nocase; content:"audio/midi"; distance:0; nocase; pcre:"/^Content-Type\s*\x3A\s*audio\x2Fmidi/smi"; flowbits:set,http.midi; flowbits:noalert; metadata:policy balanced-ips alert, policy security-ips alert, service http; classtype:misc-activity; sid:16026; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML Decoding memory corruption attempt"; flow:to_client,established; content:"charset=UTF-8|0D 0A 0D 0A F8|AAA|F8|AA|C8|"; metadata:policy security-ips drop, service http; reference:bugtraq,18309; reference:cve,2006-2382; classtype:attempted-user; sid:16032; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; uricontent:".distz"; nocase; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Edistz/smi"; metadata:service http; reference:cve,2007-0465; classtype:attempted-admin; sid:16003; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT winamp midi file header overflow attempt"; flow:to_client,established; flowbits:isset,http.midi; content:"MThd|00 00 00 06 00 00 00 01 00|`MTrk"; byte_test:4,>,2147483648,8,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,18507; reference:cve,2006-3228; classtype:attempted-user; sid:16027; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; uricontent:".pkg"; nocase; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Epkg/smi"; metadata:service http; reference:cve,2007-0465; classtype:attempted-admin; sid:16002; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer nested object tag memory corruption attempt"; flow:to_client,established; content:"<object>x<style></style>|0A|<object>x<style></style>|0A|"; metadata:policy security-ips drop, service http; reference:bugtraq,17658; reference:cve,2006-1992; classtype:attempted-user; sid:16031; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; uricontent:".mpkg"; nocase; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Empkg/smi"; metadata:service http; reference:cve,2007-0465; classtype:attempted-admin; sid:16004; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer html tag memory corruption attempt"; flow:to_client,established; content:"|09 09|pre {|0A 09 09 09|white-space|3A|normal|3B 0A|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,17468; reference:cve,2006-1188; classtype:attempted-dos; sid:16043; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Novell iManager Tomcat http post handling DoS attempt"; flow:to_server,established; uricontent:"/nps/servlet/webacc"; nocase; content:"tree="; nocase; http_cookie; pcre:"/tree\s*\x3d\s*(\d{4}|25[6-9]|2[6-9]|[3-9])/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,22657; reference:cve,2006-4517; classtype:attempted-dos; sid:16052; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GNU tar PAX extended headers handling overflow attempt"; flow:to_client,established; content:"GNU.sparse.numblocks="; nocase; pcre:"/GNU\x2esparse\x2enumblocks\s*\x3d\s*(0|[6-9]\d{4})/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,16764; reference:cve,2006-0300; classtype:attempted-dos; sid:16053; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox tag order memory corruption attempt"; flow:to_client,established; content:"BGCOLOR=|22|http|3A 22|-|9D 22 22| DP=-|B3| UNITS=|22 E2 E2 E2 E2|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,17516; reference:cve,2006-0749; classtype:attempted-user; sid:16050; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox CSS Letter-Spacing overflow attempt"; flow:to_client,established; content:"style=|22|letter-spacing|3A| -2147483648"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,17516; reference:cve,2006-1730; classtype:attempted-user; sid:16044; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Quicktime bitmap multiple header overflow"; flow:established,to_client; flowbits:isset,http.bmp; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4,>,65535,4,relative,little; byte_test:4,>,3,12,relative,little; metadata:policy security-ips drop, service http; reference:bugtraq,17953; reference:cve,2006-2238; classtype:attempted-user; sid:16054; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Internet Explorer isindex buffer overflow attempt"; flow:established,to_client; content:"<style>"; nocase; content:"<isindex>"; distance:0; fast_pattern; nocase; content:"<style>"; distance:0; nocase; metadata:policy security-ips drop, service http; reference:bugtraq,27668; reference:cve,2008-0076; reference:url,www.microsoft.com/technet/security/bulletin/ms08-010.mspx; classtype:attempted-user; sid:16063; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft ASP.NET application folder info disclosure attempt"; flow:to_server,established; content:"app_code%5c"; pcre:"/^\w+\s+[^\s]*app\x5fcode(\x255c|\x5c)/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,18920; reference:cve,2006-1300; classtype:attempted-recon; sid:16048; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft asf file download"; flow:to_client, established; content:"|0D 0A 0D 0A|0&|B2|u"; flowbits:set,http.asf; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:16143; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft SQL Server Distributed Management Objects overflow attempt"; flow:to_client,established; content:"<object classid='clsid|3A|10020200-E260-11CF-AE68-00AA004A34D5' id='SQLServer' />"; nocase; content:"progid=|22|SQLDMO.SQLServer|22|"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25594; reference:cve,2007-4814; classtype:attempted-user; sid:16208; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT HP OpenView Network Node Manager ovlaunch host field overflow attempt"; flow:to_server,established; uricontent:"ovlaunch.exe"; nocase; content:"host|3A|"; nocase; isdataat:300,relative; pcre:"/^host\x3a\s*[^\r\n]{300}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33668; reference:cve,2008-4562; classtype:attempted-user; sid:16204; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Adobe Director file format transfer"; flow:to_server,established; uricontent:".dir"; nocase; flowbits:set,http.dir; flowbits:noalert; metadata:policy balanced-ips alert, policy security-ips alert; classtype:misc-activity; sid:16219; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Kaspersky antivirus library heap buffer overflow - without optional fields"; flow:to_client,established; content:"|0D 0A 0D 0A|MSCF"; byte_test:2,&,0x0003,26,relative,little; byte_test:2,!&,0x0004,26,relative,little; pcre:"/^.{32}([^\x00]*\x00)?[^\x00]{256}/sR"; metadata:policy security-ips drop, service http; reference:bugtraq,14998; reference:cve,2005-3142; classtype:attempted-user; sid:16295; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HTML DOM invalid DHTML textnode creation attempt"; flow:to_client,established; content:"createTextNode"; pcre:"/(\w+)\s*=\s*\w+\.createTextNode\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createTextNode\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop, service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:16301; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Kaspersky antivirus library heap buffer overflow - with optional fields"; flow:to_client,established; content:"|0D 0A 0D 0A|MSCF"; byte_test:2,&,0x0003,26,relative,little; byte_test:2,&,0x0004,26,relative,little; byte_jump:2,32,relative,little; pcre:"/^.{2}([^\x00]*\x00)?[^\x00]{256}/sR"; metadata:policy security-ips drop, service http; reference:bugtraq,14998; reference:cve,2005-3142; classtype:attempted-user; sid:16296; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave Flash memory corruption attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"|FF FF FF FF 01 1F 02|H|00 00 00|6|00 00 FF FF 01 1F 1F EE|"; content:!"|FF FF FF FF|"; within:4; distance:-24; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3463; classtype:attempted-user; sid:16293; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HTML DOM invalid DHTML comment creation attempt"; flow:to_client,established; content:"createComment"; pcre:"/(\w+)\s*=\s*\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop, service http; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:16300; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Network Security Services regexp heap overflow attempt"; flow:to_client,established; content:"|16|"; content:"|0B|"; within:1; distance:4; byte_test:3,>,0,3,relative,big; content:"|06 03|U|04 03|"; distance:0; pcre:"/^[\x0c\x13]([\x00-\x7f]|\x81.|\x82.{2})\x28(?=[^\x29]*\x7e)[^\x29]*\x7c/sR"; metadata:policy balanced-ips drop, policy security-ips drop, service ssl; reference:bugtraq,35891; reference:cve,2009-2404; classtype:attempted-user; sid:16291; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IE 6/7 outerHTML invalid reference arbitrary code execution attempt"; flow:to_client,established; content:"getElement"; nocase; content:"outerHTML"; nocase; content:"overflow"; fast_pattern; nocase; pcre:"/([^\s]+)\s*=\s*document\.getElement\w+\s*\x28\s*([\x22\x27])STYLE\2.*\1\.outerHTML/si"; pcre:"/\x7b[^\x7d]*(overflow[^\x7d]*margin\s*\x3a\s*0\s*\x3b|margin\s*\x3a\s*0\s*\x3b[^\x7d]*overflow)/si"; metadata:policy security-ips drop, service http; reference:bugtraq,37085; reference:cve,2009-3672; reference:cve,2009-4054; reference:url,www.microsoft.com/technet/security/bulletin/MS09-072.mspx; classtype:attempted-user; sid:16310; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IE 6/7 single line outerHTML invalid reference arbitrary code execution attempt"; flow:to_client,established; content:"document.getElementsByTagName|28|'STYLE'|29|[0].outerHTML"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,37085; reference:cve,2009-3672; reference:cve,2009-4054; reference:url,www.microsoft.com/technet/security/bulletin/MS09-072.mspx; classtype:attempted-user; sid:16311; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT pe compact binary download"; flow:established,to_client; content:"MZ"; byte_jump:4,58,little,relative; content:"PE|00 00|"; within:4; distance:-64; content:"APECO"; distance:0; flowbits:set,download.pecompact.binary; flowbits:noalert; classtype:misc-activity; sid:13797; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Reader media.newPlayer memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/S/JavaScript/JS"; nocase; content:"this.media.newPlayer|28|null|29|"; nocase; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2009-4324; classtype:attempted-user; sid:16333; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Blackberry Server PDF JBIG2 numnewsyms remote code execution attempt"; flow:to_client, established; content:"JBIG2Decode"; nocase; content:"stream"; distance:0; pcre:"/JBIG2Decode.*?stream(\x0d\x0a|\x0a|\x0d)/smi"; byte_test:1, !&, 63, 4, relative; byte_test:4, >, 2147483647, 17, relative; metadata:service http; reference:bugtraq,35102; reference:cve,2009-2643; reference:url,www.blackberry.com/btsc/search.do?cmd=displayKC&docType=kc&externalId=KB18327; classtype:attempted-admin; sid:16336; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT xpdf ObjectStream integer overflow"; flow:established,to_client; content:"Type/ObjStm"; nocase; pcre:"/Type\x2FObjStm[^>]*?\x2FN\s+\d{7}/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,36703; reference:bugtraq,37167; reference:cve,2009-3608; classtype:attempted-user; sid:16335; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Xpdf Splash DrawImage integer overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/Subtype"; content:"/Image"; within:20; content:"/FlateDecode"; pcre:"/\x3C{2}(?=[^\x3E]*\x2F(Height|Width)\s*\d{6})(?=[^\x3E]*\x2FFlateDecode)[^\x3E]*\x2FSubtype\s*\x2FImage/"; metadata:policy security-ips drop, service http; reference:bugtraq,36703; reference:cve,2009-3604; classtype:attempted-user; sid:16355; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FFmpeg OGV file format memory corruption attempt"; flow:to_client,established; content:"OggS"; content:"|82|theora"; distance:0; byte_test:1,!&,0xE0,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36465; reference:url,secunia.com/advisories/36805; classtype:attempted-user; sid:16353; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IBM Informix Client SDK NFX file InformixServerList processing stack buffer overflow attempt"; flow:to_client,established; content:"[Setnet32]"; fast_pattern; nocase; content:"ServerSize="; distance:0; byte_test:4,>,293,0,relative,dec,string; pcre:"/InformixServerList=([^\r\n\x3B]{,293}\x3B)*[^\r\n\x3B]{294}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36588; reference:cve,2009-3691; classtype:attempted-user; sid:16346; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IBM Informix Client SDK NFX file HostList processing stack buffer overflow attempt"; flow:to_client,established; content:"[Setnet32]"; fast_pattern; nocase; content:"HostSize="; distance:0; byte_test:4,>,296,0,relative,dec,string; pcre:"/HostList=([^\r\n\x3B]{,296}\x3B)*[^\r\n\x3B]{297}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36588; reference:cve,2009-3691; classtype:attempted-user; sid:16345; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Illustrator DSC comment overflow attempt"; flow:established,to_client; content:"%!PS-Adobe-"; nocase; pcre:"/%\x21PS-Adobe-\d\s?\.\s?\d\sEPSF-\d\s?\.\s?\d\x0d\x0a/smi"; pcre:"/%[^\x0d\x0a]{1000}/smiR"; metadata:policy security-ips drop, service http; reference:bugtraq,37192; reference:cve,2009-4195; classtype:attempted-user; sid:16359; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office BMP header biClrUsed integer overflow attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"BM"; fast_pattern; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4,>,536870911,36,relative,little; metadata:policy security-ips drop, service http; reference:bugtraq,36651; reference:cve,2009-2518; classtype:attempted-admin; sid:16361; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime Image Description Atom sign extension memory corruption attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"stsd"; content:"rpza"; distance:12; fast_pattern; content:"|00 00 00 00 00 00|"; within:6; byte_test:2,>,0x1FFC,18,relative,big; metadata:policy security-ips drop, service http; reference:bugtraq,35166; reference:cve,2009-0955; reference:url,support.apple.com/kb/HT3591; classtype:attempted-user; sid:16360; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HTML+TIME animatemotion property memory corruption attempt"; flow:established,to_client; content:"ANIMATEMOTION"; nocase; pcre:"/<[A-Z_]+\s*\x3A\s*ANIMATEMOTION[^>]+?id=(?P<q>\x22|\x27|)(?P<n>[A-Z][A-Z\d\x2D\x2E\x3A\x5F]*)(?P=q).*?(?P=n)\./Osmi"; reference:bugtraq,27666; reference:cve,2008-0077; reference:url,www.microsoft.com/technet/security/bulletin/ms08-010.mspx; classtype:attempted-user; sid:16382; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Portable Executable binary file transfer"; flow:to_server,established; uricontent:".exe"; nocase; flowbits:set,http.exe; flowbits:noalert; metadata:service http; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16425; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Palm WebOS 1.2.0 floating point exception denial of service attempt"; flow:to_client,established; content:"http-equiv"; fast_pattern; content:"Content-Length|3A|"; byte_test:10,>,50279,0,relative,string; pcre:"/<meta[^>]+http-equiv\s*=\s*(["'])refresh\1[^>]*content\s*=\s*(["'])[0-9]\2/smi"; metadata:policy security-ips drop, service http; reference:url,kb.palm.com/wps/portal/kb/na/pre/p100eww/sprint/solutions/article/50607_en.html#121; reference:url,tlhsecurity.blogspot.com/2009/10/palm-pre-webos-version-11-floating.html; classtype:attempted-dos; sid:16451; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IE .hlp samba share download attempt"; flow:to_client, established; content:"vbscript"; nocase; content:".hlp"; nocase; content:"|5C|"; pcre:"/\\\\[^\x20\x0a\x0d]*\.hlp/smi"; metadata:policy security-ips drop, service http; classtype:attempted-user; sid:16452; rev:1;)
